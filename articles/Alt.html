<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The `Alt()` function in the `stokes` package • stokes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The `Alt()` function in the `stokes` package">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stokes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2-3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/stokes.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Alt.html">The `Alt()` function in the `stokes` package</a>
    </li>
    <li>
      <a href="../articles/contract.html">Functions `contract()` and `contract_elementary()` in the `stokes` package</a>
    </li>
    <li>
      <a href="../articles/dovs.html">Function `dovs()` function in the `stokes` package</a>
    </li>
    <li>
      <a href="../articles/dx.html">Objects `dx`, `dy`, and `dz` in the `stokes` package</a>
    </li>
    <li>
      <a href="../articles/ex.html">Objects `ex`, `ey`, and `ez` in the `stokes` package</a>
    </li>
    <li>
      <a href="../articles/hodge.html">The `hodge()` function in the `stokes` package</a>
    </li>
    <li>
      <a href="../articles/inner.html">The `inner()` function in the `stokes` package</a>
    </li>
    <li>
      <a href="../articles/kinner.html">The `kinner()` function in the `stokes` package</a>
    </li>
    <li>
      <a href="../articles/phi.html">Function `phi()` function in the `stokes` package</a>
    </li>
    <li>
      <a href="../articles/tensorprod.html">Function `tensorprod()` function in the `stokes` package</a>
    </li>
    <li>
      <a href="../articles/vector_cross_product.html">Functions `vector_cross_product()` and `vcp3()` in the `stokes` package</a>
    </li>
    <li>
      <a href="../articles/volume.html">Function `volume()` in the Stokes package</a>
    </li>
    <li>
      <a href="../articles/wedge.html">Functions `wedge()` and `wedge2()` in the `stokes` package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/RobinHankin/stokes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The <code>Alt()</code> function in the
<code>stokes</code> package</h1>
                        <h4 data-toc-skip class="author">Robin K. S.
Hankin</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RobinHankin/stokes/blob/master/vignettes/Alt.Rmd" class="external-link"><code>vignettes/Alt.Rmd</code></a></small>
      <div class="hidden name"><code>Alt.Rmd</code></div>

    </div>

    
    
<p><img src="../../../_temp/Library/stokes/help/figures/stokes.png" width="20%" style="float:right; padding:10px"></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Alt</span></span></code></pre></div>
<pre><code><span><span class="kw">function</span> <span class="op">(</span><span class="va">S</span>, <span class="va">give_kform</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/kform.html">is.kform</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">give_kform</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="../reference/kform.html">kform</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">factorial</a></span><span class="op">(</span><span class="fu">arity</span><span class="op">(</span><span class="va">S</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/consolidate.html">kill_trivial_rows</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu">index</span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">S</span> <span class="op">*</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="../reference/ktensor.html">ktensor</a></span><span class="op">(</span><span class="fu"><a href="../reference/consolidate.html">include_perms</a></span><span class="op">(</span><span class="fu"><a href="../reference/consolidate.html">consolidate</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">factorial</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="fu">index</span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
<p>To cite the <code>stokes</code> package in publications, please use
<span class="citation">Hankin (<a href="#ref-hankin2022_stokes">2022</a>)</span>. <span class="citation">Spivak (<a href="#ref-spivak1965">1965</a>)</span>, in
a memorable passage, states:</p>
<div class="warning" style="padding:0.1em; background-color:#E9D8FD; color:#69337A">
<span>
<p>
</p>
<p>A <span class="math inline">k</span>-tensor <span class="math inline">\omega\in{\mathcal J}(V)</span> is called
<strong>alternating</strong> if</p>
<p><span class="math display">
\omega(v_1,\ldots,v_i,\ldots,v_j,\ldots,v_k)=
-\omega(v_1,\ldots,v_j,\ldots,v_i,\ldots,v_k)\qquad\mbox{for all
$v_1,\ldots,v_k\in V$.}
</span></p>
<p><span class="math inline">\ldots</span> The set of all alternating
<span class="math inline">k</span>-tensors is clearly a subspace <span class="math inline">\Lambda^k(V)</span> of <span class="math inline">{\mathcal J}^k(V)</span>. Since it requires
considerable work to produce the determinant, it is not surprising that
alternating <span class="math inline">k</span>-tensors are difficult to
write down. There is, however, a uniform way of expressing all of them.
Recall that the sign of a permutation <span class="math inline">\sigma</span>, denoted <span class="math inline">\operatorname{sgn}\sigma</span>, is <span class="math inline">+1</span> if <span class="math inline">\sigma</span>
is even and <span class="math inline">-1</span> if <span class="math inline">\sigma</span> is odd. If <span class="math inline">T\in{\mathcal J}^k(V)</span>, we define <span class="math inline">\operatorname{Alt}(T)</span> by</p>
<p><span class="math display">
\operatorname{Alt}(T){\left(v_1,\ldots,v_k\right)}=
    \frac{1}{k!}\sum_{\sigma\in S_k}\mathrm{sgn}(\sigma)\cdot
    T{\left(v_{\sigma(1)},\ldots,v_{\sigma(k)}\right)}
</span></p>
<p>where <span class="math inline">S_k</span> is the set of all
permutations of numbers <span class="math inline">1</span> to <span class="math inline">k</span>.</p>

<p style="margin-bottom:1em; margin-right:1em; text-align:right; font-family:Georgia">
<b>- Michael Spivak, 1969</b> <i>(Calculus on Manifolds, Perseus books).
Page 78</i>
</p>
<p></p></span>
</div>
<p>For example, if <span class="math inline">k=3</span> we have</p>
<p><span class="math display">\operatorname{Alt}(T)\left(v_1,v_2,v_3\right)=
      \frac{1}{6}\left(\begin{array}{cc}
      +T{\left(v_1,v_2,v_3\right)}&amp;
      -T{\left(v_1,v_3,v_2\right)}\cr
      -T{\left(v_2,v_1,v_3\right)}&amp;
      +T{\left(v_2,v_3,v_1\right)}\cr
      +T{\left(v_3,v_1,v_2\right)}&amp;
      -T{\left(v_3,v_2,v_1\right)}
      \end{array}
      \right)
</span></p>
<p>In the <code>stokes</code> package, function <code><a href="../reference/Alt.html">Alt()</a></code>
performs this operation on a given <span class="math inline">k</span>-tensor <span class="math inline">T</span>.
Idiom is straightforward:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">6</span>  <span class="co"># the "6" is to stop rounding error</span></span>
<span><span class="va">S</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^3 to R with V=R^8:</span></span>
<span><span class="co">##            val</span></span>
<span><span class="co">##  1 7 8  =    6</span></span></code></pre>
<p>Above, object <span class="math inline">S=6\phi_1\otimes\phi_7\otimes\phi_8</span>, where
<span class="math inline">\phi_i\colon\mathbb{R}^8\longrightarrow\mathbb{R}</span>,
with <span class="math inline">\phi_i(e_j)=\delta_{ij}</span> [<span class="math inline">e_j</span> are basis vectors in <span class="math inline">\mathbb{R}^8</span>]. We may calculate <span class="math inline">\operatorname{Alt}(S)</span> in the package using
<code><a href="../reference/Alt.html">Alt()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^3 to R with V=R^8:</span></span>
<span><span class="co">##            val</span></span>
<span><span class="co">##  8 7 1  =   -1</span></span>
<span><span class="co">##  8 1 7  =    1</span></span>
<span><span class="co">##  7 8 1  =    1</span></span>
<span><span class="co">##  7 1 8  =   -1</span></span>
<span><span class="co">##  1 8 7  =   -1</span></span>
<span><span class="co">##  1 7 8  =    1</span></span></code></pre>
<p>Above we see that <span class="math inline">\operatorname{Alt}(S)=\phi_1\otimes\phi_7\otimes\phi_8-\phi_1\otimes\phi_8\otimes\phi_7\pm\cdots
-\phi_8\otimes\phi_7\otimes\phi_1</span>, and we can see the pattern
clearly, observing in passing that the order of the rows in the R object
is arbitrary (as per <code>disordR</code> discipline). Now,
<code>Alt(S)</code> is an alternating form, which is easy to verify, by
making it act on an odd permutation of a set of vectors:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">24</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="va">V</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="va">V</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.1645455  0.1645455</span></span></code></pre>
<p>Observing that <span class="math inline">\operatorname{Alt}</span> is
linear, we might apply it to a more complicated tensor, here with two
terms:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^3 to R with V=R^4:</span></span>
<span><span class="co">##             val</span></span>
<span><span class="co">##  2 2 3  =  1000</span></span>
<span><span class="co">##  1 2 4  =    12</span></span></code></pre>
<p>Above we have <span class="math inline">S=12\phi_1\otimes\phi_2\otimes\phi_4+1000\phi_2\otimes\phi_2\otimes\phi_3</span>.
Calculating <span class="math inline">\operatorname{Alt}(S)</span>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^3 to R with V=R^4:</span></span>
<span><span class="co">##             val</span></span>
<span><span class="co">##  2 2 3  =  1000</span></span>
<span><span class="co">##  1 2 4  =    12</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^3 to R with V=R^4:</span></span>
<span><span class="co">##            val</span></span>
<span><span class="co">##  4 2 1  =   -2</span></span>
<span><span class="co">##  4 1 2  =    2</span></span>
<span><span class="co">##  2 4 1  =    2</span></span>
<span><span class="co">##  2 1 4  =   -2</span></span>
<span><span class="co">##  1 4 2  =   -2</span></span>
<span><span class="co">##  1 2 4  =    2</span></span></code></pre>
<p>Note that the <code>2 2 3</code> term (with coefficient 1000)
disappears in <code>Alt(S)</code>: the even permutations (being
positive) cancel out the odd permutations (being negative) in pairs.
This must be the case for an alternating map by definition. We can see
why this cancellation occurs by considering <span class="math inline">T=\phi_2\otimes\phi_2\otimes\phi_3</span>, a linear
map corresponding to the <code>[2 2 3]</code> row of <code>S</code>:</p>
<p><span class="math display">
T(v_1,v_2,v_3) = (v_1\cdot e_2)(v_2\cdot e_2)(v_1\cdot e_3)x
</span></p>
<p>(where <span class="math inline">x\in\mathbb{R}</span> is any real
number and “<span class="math inline">\cdot</span>” denotes the dot
product), and so</p>
<p><span class="math display">
T(v_2,v_1,v_3) = (v_2\cdot e_2)(v_1\cdot e_2)(v_3\cdot e_3)x =
T(v_1,v_2,v_3).
</span></p>
<p>Thus if we require <span class="math inline">T</span> to be
alternating [that is, <span class="math inline">T(v_2,v_1,v_3) =
-T(v_1,v_2,v_3)</span>], we must have <span class="math inline">x=0</span>, which is why the <code>[2 2 3]</code>
term with coefficient 1000 vanishes (such terms are killed in the
function by applying <code><a href="../reference/consolidate.html">kill_trivial_rows()</a></code>). We can check
that terms with repeated entries are correctly discarded by taking the
<span class="math inline">\operatorname{Alt}</span> of a tensor all of
whose entries include at least one repeat:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span>,</span>
<span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">4</span>,</span>
<span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,</span>
<span><span class="fl">7</span>,<span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">7</span>,</span>
<span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span></span>
<span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">4</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">S</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^4 to R with V=R^7:</span></span>
<span><span class="co">##              val</span></span>
<span><span class="co">##  1 2 3 3  =    5</span></span>
<span><span class="co">##  7 7 4 7  =    4</span></span>
<span><span class="co">##  1 1 2 3  =    3</span></span>
<span><span class="co">##  1 4 1 4  =    2</span></span>
<span><span class="co">##  3 2 1 1  =    1</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The zero linear map from V^4 to R with V=R^n:</span></span>
<span><span class="co">## empty sparse array with 4 columns</span></span></code></pre>
<p>We should verify that <code><a href="../reference/Alt.html">Alt()</a></code> does indeed return an
alternating tensor for complicated tensors (this is trivial
algebraically because <span class="math inline">\operatorname{Alt}(\cdot)</span> is linear, but it
is always good to check):</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rform.html">rtensor</a></span><span class="op">(</span>k<span class="op">=</span><span class="fl">5</span>,n<span class="op">=</span><span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">S</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^5 to R with V=R^9:</span></span>
<span><span class="co">##                val</span></span>
<span><span class="co">##  6 1 1 1 2  =    9</span></span>
<span><span class="co">##  8 6 7 6 6  =    8</span></span>
<span><span class="co">##  7 6 8 7 3  =    7</span></span>
<span><span class="co">##  8 2 7 7 7  =    5</span></span>
<span><span class="co">##  9 8 6 9 9  =    4</span></span>
<span><span class="co">##  6 6 8 9 1  =    3</span></span>
<span><span class="co">##  9 2 6 4 7  =    6</span></span>
<span><span class="co">##  7 3 3 8 6  =    2</span></span>
<span><span class="co">##  9 7 3 4 5  =    1</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span>
<span><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">45</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="co"># element of (R^9)^5</span></span></code></pre></div>
<p>Then we swap columns of <span class="math inline">V</span>, using
both even and odd permutations, to verify that <span class="math inline">\operatorname{Alt}(S)</span> is in fact
alternating:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">V_even</span> <span class="op">&lt;-</span> <span class="va">V</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>  <span class="co"># an even permutation</span></span>
<span><span class="va">V_odd</span>  <span class="op">&lt;-</span> <span class="va">V</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>  <span class="co"># an odd permutation</span></span>
<span><span class="va">V_rep</span>  <span class="op">&lt;-</span> <span class="va">V</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>  <span class="co"># not a permutation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">AS</span><span class="op">)</span><span class="op">(</span><span class="va">V</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">AS</span><span class="op">)</span><span class="op">(</span><span class="va">V_even</span><span class="op">)</span><span class="op">)</span>   <span class="co"># should be identical (even permutation)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.226959 0.226959</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">AS</span><span class="op">)</span><span class="op">(</span><span class="va">V</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">AS</span><span class="op">)</span><span class="op">(</span><span class="va">V_odd</span><span class="op">)</span><span class="op">)</span>    <span class="co"># should differ in sign only (odd permutation)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  0.226959 -0.226959</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">AS</span><span class="op">)</span><span class="op">(</span><span class="va">V_rep</span><span class="op">)</span>                          <span class="co"># should be zero</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -1.01644e-20</span></span></code></pre>
<div class="section level2">
<h2 id="further-properties-of-alt">Further properties of <code>Alt()</code><a class="anchor" aria-label="anchor" href="#further-properties-of-alt"></a>
</h2>
<p>In his theorem 4.3, Spivak proves the following statements:</p>
<ul>
<li>If <span class="math inline">T</span> is a tensor, then <span class="math inline">\operatorname{Alt}(T)</span> is alternating</li>
<li>If <span class="math inline">\omega</span> is alternating [he writes
<span class="math inline">\omega\in\Lambda^k(V)</span>] then <span class="math inline">\operatorname{Alt}(\omega)=\omega</span>
</li>
<li>If <span class="math inline">T</span> is a tensor, then <span class="math inline">\operatorname{Alt}(\operatorname{Alt}(T))=\operatorname{Alt}(T)</span>.</li>
</ul>
<p>We have demonstrated the first point above. For the second, we need
to construct a tensor that is alternating, and then show that
<code><a href="../reference/Alt.html">Alt()</a></code> does not change it:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">P</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^2 to R with V=R^2:</span></span>
<span><span class="co">##          val</span></span>
<span><span class="co">##  1 2  =    7</span></span>
<span><span class="co">##  2 1  =   -7</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">==</span> <span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>The third point, idempotence is also easy:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rform.html">rtensor</a></span><span class="op">(</span><span class="op">)</span><span class="op">*</span><span class="fl">6</span> <span class="co"># the "6" avoids numerical round-off issues</span></span>
<span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span>   <span class="co"># should be TRUE</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="wedge-product">Wedge product<a class="anchor" aria-label="anchor" href="#wedge-product"></a>
</h2>
<p>(Main article: <a href="wedge.html">wedge product</a>). Spivak
defines the wedge product as follows. Given alternating forms <span class="math inline">\omega\in\Lambda^k(V)</span> and <span class="math inline">\eta\in\Lambda^l(V)</span> we have</p>
<p><span class="math display">
\omega\wedge\eta=\frac{(k+l)!}{k!l!}\operatorname{Alt}(\omega\otimes\eta)
</span></p>
<p>So for example:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="fl">2</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="fu"><a href="../reference/ktensor.html">ktensor</a></span><span class="op">(</span><span class="fl">6</span><span class="op">*</span><span class="fu"><a href="../reference/coeffs.html">spray</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fl">3</span>,<span class="fl">3</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">omega</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^2 to R with V=R^3:</span></span>
<span><span class="co">##          val</span></span>
<span><span class="co">##  2 3  =    7</span></span>
<span><span class="co">##  3 2  =   -7</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eta</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^3 to R with V=R^7:</span></span>
<span><span class="co">##            val</span></span>
<span><span class="co">##  1 4 7  =    2</span></span>
<span><span class="co">##  3 2 1  =   -1</span></span>
<span><span class="co">##  4 6 5  =   -3</span></span>
<span><span class="co">##  1 7 4  =   -2</span></span>
<span><span class="co">##  4 5 6  =    3</span></span>
<span><span class="co">##  7 1 4  =    2</span></span>
<span><span class="co">##  4 1 7  =   -2</span></span>
<span><span class="co">##  4 7 1  =    2</span></span>
<span><span class="co">##  6 5 4  =   -3</span></span>
<span><span class="co">##  6 4 5  =    3</span></span>
<span><span class="co">##  5 4 6  =   -3</span></span>
<span><span class="co">##  1 3 2  =   -1</span></span>
<span><span class="co">##  2 1 3  =   -1</span></span>
<span><span class="co">##  1 2 3  =    1</span></span>
<span><span class="co">##  2 3 1  =    1</span></span>
<span><span class="co">##  7 4 1  =   -2</span></span>
<span><span class="co">##  3 1 2  =    1</span></span>
<span><span class="co">##  5 6 4  =    3</span></span></code></pre>
<p>Above we see that <code>omega</code> is alternating by construction,
and <code>eta</code> is alternating by virtue of <code><a href="../reference/Alt.html">Alt()</a></code>.
Thus tensor <span class="math inline">\omega\wedge\eta</span> is defined
as per Spivak’s definition, and we may calculate it directly:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">omega</span> <span class="op"><a href="../reference/tensorprod.html">%X%</a></span> <span class="va">eta</span>,give_kform <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^5 to R with V=R^7:</span></span>
<span><span class="co">##                val</span></span>
<span><span class="co">##  2 3 4 5 6  =  2.1</span></span>
<span><span class="co">##  1 2 3 4 7  =  1.4</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">omega</span> <span class="op"><a href="../reference/tensorprod.html">%X%</a></span> <span class="va">eta</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Observe that the tensor <span class="math inline">\omega\otimes\eta</span> (which would be returned if
the default argument <code>give_kform=FALSE</code> was sent to
<code><a href="../reference/Alt.html">Alt()</a></code>) is quite long, having <span class="math inline">2\cdot 5!=240</span> nonzero components, which is
why it is not printed in full. We may verify that <code>f()</code> is
alternating by evaluating it on a randomly chosen point in <span class="math inline">\left(\mathbb{R}^7\right)^5</span>:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">V</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">35</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">V</span><span class="op">)</span>,<span class="fu">f</span><span class="op">(</span><span class="va">V</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.852457  0.852457</span></span></code></pre>
<p>Above we see a verification that <code>f()</code> is fact
alternating: writing the matrix <code>V</code> in terms of its five
vectors as <span class="math inline">V=\left[v_1,v_2,v_3,v_4,v_5\right]</span>, where
<span class="math inline">v_i\in\mathbb{R}^7</span>, we see that <span class="math inline">f{\left(v_1,v_2,v_3,v_4,v_5\right)}=-f{\left(v_2,v_1,v_3,v_4,v_5\right)}</span>.</p>
<div class="section level3">
<h3 id="further-further-properties-of-alt">Further further properties of <code>Alt()</code><a class="anchor" aria-label="anchor" href="#further-further-properties-of-alt"></a>
</h3>
<p>Spivak goes on to prove the following three statements. If <span class="math inline">S,T</span> are tensors and <span class="math inline">\omega,\eta,\theta</span> are alternating tensors of
arity <span class="math inline">k,l,m</span> respectively, then</p>
<ul>
<li>If <span class="math inline">\operatorname{Alt}(S)=0</span>, then
<span class="math inline">\operatorname{Alt}(S\otimes
T)=\operatorname{Alt}(T\otimes S)=0</span>.</li>
<li><span class="math inline">\operatorname{Alt}(\operatorname{Alt}(\omega\otimes\eta)\otimes\theta)
=\operatorname{Alt}(\omega\otimes\eta\otimes\theta)=
\operatorname{Alt}(\omega\otimes\operatorname{Alt}(\eta\otimes\theta))</span></li>
<li>
<span class="math inline">(\omega\wedge\eta)\wedge\theta =
\omega\wedge(\eta\wedge\theta) =
\frac{(k+l+m)!}{k!l!m!}\operatorname{Alt}(\omega\otimes\eta\otimes\theta)</span>.</li>
</ul>
<p>Taking the points in turn. Firstly <span class="math inline">\operatorname{Alt}(S\otimes
T)=\operatorname{Alt}(T\otimes S)=0</span>:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>,<span class="fl">1000</span><span class="op">:</span><span class="fl">1001</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^4 to R with V=R^3:</span></span>
<span><span class="co">##               val</span></span>
<span><span class="co">##  1 1 2 3  =  1001</span></span>
<span><span class="co">##  1 2 3 3  =  1000</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span>  <span class="co"># each row of S includes repeats</span></span></code></pre></div>
<pre><code><span><span class="co">## The zero linear map from V^4 to R with V=R^n:</span></span>
<span><span class="co">## empty sparse array with 4 columns</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="cn">T</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rform.html">rtensor</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/zero.html">is.zero</a></span><span class="op">(</span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">S</span> <span class="op"><a href="../reference/tensorprod.html">%X%</a></span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/zero.html">is.zero</a></span><span class="op">(</span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="cn">T</span> <span class="op"><a href="../reference/tensorprod.html">%X%</a></span> <span class="va">S</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE TRUE</span></span></code></pre>
<p>secondly, <span class="math inline">\operatorname{Alt}(\operatorname{Alt}(\omega\otimes\eta)\otimes\theta)
  =\operatorname{Alt}(\omega\otimes\eta\otimes\theta)=
  \operatorname{Alt}(\omega\otimes\operatorname{Alt}(\eta\otimes\theta))</span>:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>,<span class="fl">14</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">omega</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^3 to R with V=R^3:</span></span>
<span><span class="co">##            val</span></span>
<span><span class="co">##  3 2 1  =   -1</span></span>
<span><span class="co">##  3 1 2  =    1</span></span>
<span><span class="co">##  2 3 1  =    1</span></span>
<span><span class="co">##  2 1 3  =   -1</span></span>
<span><span class="co">##  1 3 2  =   -1</span></span>
<span><span class="co">##  1 2 3  =    1</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eta</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^2 to R with V=R^5:</span></span>
<span><span class="co">##          val</span></span>
<span><span class="co">##  5 4  =  -30</span></span>
<span><span class="co">##  4 5  =   30</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^2 to R with V=R^7:</span></span>
<span><span class="co">##          val</span></span>
<span><span class="co">##  7 6  =   -7</span></span>
<span><span class="co">##  6 7  =    7</span></span></code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">omega</span> <span class="op"><a href="../reference/tensorprod.html">%X%</a></span> <span class="va">eta</span><span class="op">)</span> <span class="op"><a href="../reference/tensorprod.html">%X%</a></span> <span class="va">theta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">omega</span> <span class="op"><a href="../reference/tensorprod.html">%X%</a></span> <span class="va">eta</span> <span class="op"><a href="../reference/tensorprod.html">%X%</a></span> <span class="va">theta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">omega</span> <span class="op"><a href="../reference/tensorprod.html">%X%</a></span> <span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">eta</span> <span class="op"><a href="../reference/tensorprod.html">%X%</a></span> <span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">9</span><span class="op">*</span><span class="fl">14</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">9</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">f1</span><span class="op">(</span><span class="va">V</span><span class="op">)</span>,<span class="fu">f2</span><span class="op">(</span><span class="va">V</span><span class="op">)</span>,<span class="fu">f3</span><span class="op">(</span><span class="va">V</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -3.154794 -3.154794 -3.154794</span></span></code></pre>
<p>Verifying the third identity <span class="math inline">(\omega\wedge\eta)\wedge\theta =
  \omega\wedge(\eta\wedge\theta) =
  \frac{(k+l+m)!}{k!l!m!}\operatorname{Alt}(\omega\otimes\eta\otimes\theta)</span>
needs us to coerce from a <span class="math inline">k</span>-form to a
<span class="math inline">k</span>-tensor:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rform.html">rform</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">19</span><span class="op">)</span></span>
<span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rform.html">rform</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">19</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rform.html">rform</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">19</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="va">omega</span> <span class="op">^</span> <span class="op">(</span><span class="va">eta</span> <span class="op">^</span> <span class="va">theta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">a2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="op">(</span><span class="va">omega</span> <span class="op">^</span> <span class="va">eta</span><span class="op">)</span> <span class="op">^</span> <span class="va">theta</span><span class="op">)</span></span>
<span><span class="va">a3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="va">omega</span><span class="op">)</span> <span class="op"><a href="../reference/tensorprod.html">%X%</a></span> <span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span> <span class="op"><a href="../reference/tensorprod.html">%X%</a></span> <span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">90</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/zero.html">is.zero</a></span><span class="op">(</span><span class="va">a1</span><span class="op">-</span><span class="va">a2</span><span class="op">)</span>,<span class="fu"><a href="../reference/zero.html">is.zero</a></span><span class="op">(</span><span class="va">a1</span><span class="op">-</span><span class="va">a3</span><span class="op">)</span>,<span class="fu"><a href="../reference/zero.html">is.zero</a></span><span class="op">(</span><span class="va">a2</span><span class="op">-</span><span class="va">a3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE TRUE TRUE</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="argument-give_kform">Argument <code>give_kform</code><a class="anchor" aria-label="anchor" href="#argument-give_kform"></a>
</h2>
<p>Function <code><a href="../reference/Alt.html">Alt()</a></code> takes a Boolean argument
<code>give_kform</code>. We have been using <code><a href="../reference/Alt.html">Alt()</a></code> with
<code>give_kform</code> taking its default value of <code>FALSE</code>,
which means that it returns an object of class <code>ktensor</code>.
However, an alternating form can be much more efficiently represented as
an object of class <code>kform</code>, and this is returned if
<code>give_kform</code> is <code>TRUE</code>. Here I verify that the two
options return identical objects:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">rand_tensor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rform.html">rtensor</a></span><span class="op">(</span>k<span class="op">=</span><span class="fl">5</span>,n<span class="op">=</span><span class="fl">9</span><span class="op">)</span><span class="op">*</span><span class="fl">120</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^5 to R with V=R^9:</span></span>
<span><span class="co">##                 val</span></span>
<span><span class="co">##  7 3 6 4 7  =   120</span></span>
<span><span class="co">##  8 1 3 4 4  =   240</span></span>
<span><span class="co">##  2 6 4 5 7  =   360</span></span>
<span><span class="co">##  8 4 2 8 8  =   840</span></span>
<span><span class="co">##  7 1 3 5 1  =   480</span></span>
<span><span class="co">##  1 6 4 7 6  =   600</span></span>
<span><span class="co">##  6 7 3 3 4  =  1080</span></span>
<span><span class="co">##  9 2 3 5 3  =   720</span></span>
<span><span class="co">##  6 5 6 5 4  =   960</span></span></code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">rand_tensor</span><span class="op">)</span>  <span class="co"># 120 terms, too long to print all of it</span></span>
<span><span class="fu"><a href="../reference/summary.html">summary</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A ktensor object with 120 terms.  Summary of coefficients: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## a disord object with hash 866c13390582e2f7e562be3e046abda44be30079 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">##      -3      -3       0       0       3       3 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Representative selection of index and coefficients:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## A linear map from V^5 to R with V=R^7:</span></span>
<span><span class="co">##                val</span></span>
<span><span class="co">##  7 6 5 4 2  =    3</span></span>
<span><span class="co">##  2 6 4 7 5  =   -3</span></span>
<span><span class="co">##  7 4 2 6 5  =    3</span></span>
<span><span class="co">##  2 7 6 4 5  =   -3</span></span>
<span><span class="co">##  4 6 2 5 7  =   -3</span></span>
<span><span class="co">##  6 5 2 4 7  =   -3</span></span></code></pre>
<p>Above, we see that <code>S1</code> is a rather extensive object, with
120 terms. However, if argument <code>give_kform = TRUE</code> is passed
to <code><a href="../reference/Alt.html">Alt()</a></code> we get a <code>kform</code> object which is much
more succinct:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">SA1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">rand_tensor</span>,give_kform<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^5 to R with V=R^7:</span></span>
<span><span class="co">##                val</span></span>
<span><span class="co">##  2 4 5 6 7  =    3</span></span></code></pre>
<p>Verification that objects <code>S1</code> and <code>SA1</code> are
the same object:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">45</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">LHS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">(</span><span class="va">V</span><span class="op">)</span></span>
<span><span class="va">RHS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">SA1</span><span class="op">)</span><span class="op">(</span><span class="va">V</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>LHS<span class="op">=</span><span class="va">LHS</span>,RHS<span class="op">=</span><span class="va">RHS</span>,diff<span class="op">=</span><span class="va">LHS</span><span class="op">-</span><span class="va">RHS</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           LHS           RHS          diff </span></span>
<span><span class="co">##  2.386928e+01  2.386928e+01 -1.065814e-14</span></span></code></pre>
<p>Above we see agreement to within numerical error.</p>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-hankin2022_stokes" class="csl-entry">
Hankin, R. K. S. 2022. <span>“Stokes’s Theorem in
<span>R</span>.”</span> arXiv. <a href="https://doi.org/10.48550/ARXIV.2210.17008" class="external-link">https://doi.org/10.48550/ARXIV.2210.17008</a>.
</div>
<div id="ref-spivak1965" class="csl-entry">
Spivak, M. 1965. <em>Calculus on Manifolds</em>. Addison-Wesley.
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Robin K. S. Hankin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
