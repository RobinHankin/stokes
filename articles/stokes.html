<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Exterior calculus with R • stokes</title>
<script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Exterior calculus with R">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">stokes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2-1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/stokes.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Alt.html">The `Alt()` function in the `stokes` package</a></li>
    <li><a class="dropdown-item" href="../articles/contract.html">Functions `contract()` and `contract_elementary()` in the `stokes` package</a></li>
    <li><a class="dropdown-item" href="../articles/dovs.html">Function `dovs()` function in the `stokes` package</a></li>
    <li><a class="dropdown-item" href="../articles/dx.html">Objects `dx`, `dy`, and `dz` in the `stokes` package</a></li>
    <li><a class="dropdown-item" href="../articles/ex.html">Objects `ex`, `ey`, and `ez` in the `stokes` package</a></li>
    <li><a class="dropdown-item" href="../articles/hodge.html">The `hodge()` function in the `stokes` package</a></li>
    <li><a class="dropdown-item" href="../articles/inner.html">The `inner()` function in the `stokes` package</a></li>
    <li><a class="dropdown-item" href="../articles/kinner.html">The `kinner()` function in the `stokes` package</a></li>
    <li><a class="dropdown-item" href="../articles/vector_cross_product.html">Functions `vector_cross_product()` and `vcp3()` in the `stokes` package</a></li>
    <li><a class="dropdown-item" href="../articles/volume.html">Function `volume()` in the Stokes package</a></li>
    <li><a class="dropdown-item" href="../articles/wedge.html">Functions `wedge()` and `wedge2()` in the `stokes` package</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RobinHankin/stokes/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Exterior calculus with R</h1>
                        <h4 data-toc-skip class="author">Robin K. S.
Hankin</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RobinHankin/stokes/blob/master/vignettes/stokes.Rmd" class="external-link"><code>vignettes/stokes.Rmd</code></a></small>
      <div class="d-none name"><code>stokes.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="the-stokes-package">The <code>stokes</code> package<a class="anchor" aria-label="anchor" href="#the-stokes-package"></a>
</h2>
<p><img src="../../../_temp/Library/stokes/help/figures/stokes.png" width="20%" style="float:right; padding:10px"></p>
<p>To cite the <code>stokes</code> package in publications please use
<span class="citation">(Hankin 2022c)</span>. Ordinary differential
calculus may be formalized and generalized to arbitrary-dimensional
oriented manifolds using the exterior calculus. Here I show how the
<code>stokes</code> package furnishes functionality for working with the
exterior calculus, and provide numerical verification of a number of
theorems. Notation follows that of <span class="citation">Spivak
(1965)</span>, and <span class="citation">Hubbard and Hubbard
(2015)</span>.</p>
<p>Recall that a <span class="math inline">k</span>-tensor is a
multilinear map <span class="math inline">S\colon
V^k\longrightarrow\mathbb{R}</span>, where <span class="math inline">V=\mathbb{R}^n</span> is considered as a vector
space; Spivak denotes the space of multilinear maps as <span class="math inline">\mathcal{J}^k(V)</span>. Formally, multilinearity
means</p>
<p><span class="math display">
S{\left(v_1,\ldots,av_i,\ldots,v_k\right)} = a\cdot
S{\left(v_1,\ldots,v_i,\ldots,v_k\right)}
</span></p>
<p>and</p>
<p><span class="math display">
S{\left(v_1,\ldots,v_i+{v_i}',\ldots,v_k\right)}=S{\left(v_1,\ldots,v_i,\ldots,x_v\right)}+
S{\left(v_1,\ldots,{v_i}',\ldots,v_k\right)}.
</span></p>
<p>where <span class="math inline">v_i\in V</span>. If <span class="math inline">S\in\mathcal{J}^k(V)</span> and <span class="math inline">T\in\mathcal{J}^l(V)</span>, then we may define
<span class="math inline">S\otimes
T\in\mathcal{J}^{k+l}(V)</span> as</p>
<p><span class="math display">
S\otimes T{\left(v_1,\ldots,v_k,v_{k+1},\ldots,v_{k+l}\right)}=
S{\left(v_1,\ldots,v_k\right)}\cdot
T{\left(v_1,\ldots,v_l\right)}.
</span></p>
<p>Spivak observes that <span class="math inline">\mathcal{J}^k(V)</span> is spanned by the <span class="math inline">n^k</span> products of the form</p>
<p><span class="math display">
\phi_{i_1}\otimes\phi_{i_2}\otimes\cdots\otimes\phi_{i_k}\qquad
1\leq i_i,i_2,\ldots,i_k\leq n
</span></p>
<p>where <span class="math inline">v_1,\ldots,v_k</span> is a basis for
<span class="math inline">V</span> and <span class="math inline">\phi_i{\left(v_j\right)}=\delta_{ij}</span>; we can
therefore write</p>
<p><span class="math display">
S=\sum_{1\leq i_1,\ldots,i_k\leq n} a_{i_1\ldots i_k}
\phi_{i_1}\otimes\cdots\otimes\phi_{i_k}.
</span></p>
<p>The space spanned by such products has a natural representation in R
as an array of dimensions <span class="math inline">n\times\cdots\times
n=n^k</span>. If <code>A</code> is such an array, then the element
<code>A[i_1,i_2,...,i_k]</code> is the coefficient of <span class="math inline">\phi_{i_1}\otimes\ldots\otimes\phi_{i_k}</span>.
However, it is more efficient and conceptually cleaner to consider a
<em>sparse</em> array, as implemented by the <code>spray</code> package.
We will consider the case <span class="math inline">n=5,k=4</span>, so
we have multilinear maps from <span class="math inline">\left(\mathbb{R}^5\right)^4</span> to <span class="math inline">\mathbb{R}</span>. Below, we will test algebraic
identities in R using the idiom furnished by the stokes package. For our
example we will define <span class="math inline">S=1.5\phi_5\otimes\phi_1\otimes\phi_1\otimes\phi_1+2.5\phi_1\otimes\phi_1\otimes\phi_2\otimes\phi_3+3.5\phi_1\otimes\phi_3\otimes\phi_4\otimes\phi_2</span>
using a matrix with three rows, one per term, and whose rows correspond
to each term’s tensor products of the <span class="math inline">\phi</span>’s. We first have to load the
<code>stokes</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/RobinHankin/stokes" class="external-link">"stokes"</a></span><span class="op">)</span></span></code></pre></div>
<p>Then the idiom is straightforward:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>, <span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>, <span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fl">3</span>,<span class="fl">4</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">M</span></span></code></pre></div>
<pre><code><span><span class="co">##      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">## [1,]    5    1    1    1</span></span>
<span><span class="co">## [2,]    1    1    2    3</span></span>
<span><span class="co">## [3,]    1    3    4    2</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="va">M</span>,coeffs<span class="op">=</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">S</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^4 to R with V=R^5:</span></span>
<span><span class="co">##              val</span></span>
<span><span class="co">##  1 3 4 2  =  3.5</span></span>
<span><span class="co">##  1 1 2 3  =  2.5</span></span>
<span><span class="co">##  5 1 1 1  =  1.5</span></span></code></pre>
<p>Observe that, if stored as an array of size <span class="math inline">n^k</span>, <span class="math inline">S</span> would
have <span class="math inline">5^4=625</span> elements, all but three of
which are zero. So <span class="math inline">S</span> is a 4-tensor,
mapping <span class="math inline">V^4</span> to <span class="math inline">\mathbb{R}</span>, where <span class="math inline">V=\mathbb{R}^5</span>. Here we have <span class="math inline">S=1.5\phi_5\otimes\phi_1\otimes\phi_1\otimes\phi_1+2.5\phi_1\otimes\phi_1\otimes\phi_2\otimes\phi_3+3.5\phi_1\otimes\phi_3\otimes\phi_4\otimes\phi_2</span>.
Note that in some implementations the row order of object <code>S</code>
will differ from that of <code>M</code>; this phenomenon is due to the
underlying <code>C</code> implementation using the <code>STL map</code>
class; see the <code>disordR</code> package <span class="citation">(Hankin 2022a)</span> and is discussed in more detail
in the <code>mvp</code> package <span class="citation">(Hankin
2022b)</span>.</p>
<div class="section level4">
<h4 id="package-idiom-for-evaluation-of-a-tensor">Package idiom for evaluation of a tensor<a class="anchor" aria-label="anchor" href="#package-idiom-for-evaluation-of-a-tensor"></a>
</h4>
<p>First, we will define <span class="math inline">E</span> to be a
random point in <span class="math inline">V^k</span> in terms of a
matrix:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">k</span><span class="op">)</span>,<span class="va">n</span>,<span class="va">k</span><span class="op">)</span><span class="op">)</span>   <span class="co"># A random point in V^k</span></span></code></pre></div>
<pre><code><span><span class="co">##            [,1]         [,2]       [,3]       [,4]</span></span>
<span><span class="co">## [1,]  1.2629543 -1.539950042  0.7635935 -0.4115108</span></span>
<span><span class="co">## [2,] -0.3262334 -0.928567035 -0.7990092  0.2522234</span></span>
<span><span class="co">## [3,]  1.3297993 -0.294720447 -1.1476570 -0.8919211</span></span>
<span><span class="co">## [4,]  1.2724293 -0.005767173 -0.2894616  0.4356833</span></span>
<span><span class="co">## [5,]  0.4146414  2.404653389 -0.2992151 -1.2375384</span></span></code></pre>
<p>Recall that <span class="math inline">n=5</span>, <span class="math inline">k=4</span>, so <span class="math inline">E\in\left(\mathbb{R}^5\right)^4</span>. We can
evaluate <span class="math inline">S</span> at <span class="math inline">E</span> as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="va">E</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -3.068997</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="vector-space-structure-of-tensors">Vector space structure of tensors<a class="anchor" aria-label="anchor" href="#vector-space-structure-of-tensors"></a>
</h4>
<p>Tensors have a natural vector space structure; they may be added and
subtracted, and multiplied by a scalar, the same as any other vector
space. Below, we define a new tensor <span class="math inline">S_1</span> and work with <span class="math inline">2S-3S_1</span>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fl">2</span><span class="op">*</span><span class="va">S</span><span class="op">-</span><span class="fl">3</span><span class="op">*</span><span class="va">S1</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^4 to R with V=R^5:</span></span>
<span><span class="co">##              val</span></span>
<span><span class="co">##  1 3 4 2  =    7</span></span>
<span><span class="co">##  1 1 2 3  =    5</span></span>
<span><span class="co">##  5 1 1 1  =    3</span></span>
<span><span class="co">##  1 1 1 2  =  -12</span></span>
<span><span class="co">##  1 1 2 1  =   -9</span></span>
<span><span class="co">##  1 2 1 1  =   -6</span></span>
<span><span class="co">##  2 1 1 1  =   -3</span></span></code></pre>
<p>We may verify that tensors are linear using package idiom:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LHS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">S</span><span class="op">-</span><span class="fl">3</span><span class="op">*</span><span class="va">S1</span><span class="op">)</span><span class="op">(</span><span class="va">E</span><span class="op">)</span></span>
<span><span class="va">RHS</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span><span class="op">(</span><span class="va">E</span><span class="op">)</span> <span class="op">-</span><span class="fl">3</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">(</span><span class="va">E</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lhs<span class="op">=</span><span class="va">LHS</span>,rhs<span class="op">=</span><span class="va">RHS</span>,diff<span class="op">=</span><span class="va">LHS</span><span class="op">-</span><span class="va">RHS</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           lhs           rhs          diff </span></span>
<span><span class="co">##  2.374816e+00  2.374816e+00 -4.440892e-16</span></span></code></pre>
<p>(that is, identical up to numerical precision).</p>
</div>
<div class="section level4">
<h4 id="numerical-verification-of-multilinearity-in-the-package">Numerical verification of multilinearity in the package<a class="anchor" aria-label="anchor" href="#numerical-verification-of-multilinearity-in-the-package"></a>
</h4>
<p>Testing multilinearity is straightforward in the package. To do this,
we need to define three matrices <code>E1,E2,E3</code> corresponding to
points in <span class="math inline">\left(\mathbb{R}^5\right)^4</span>
which are identical except for one column. In <code>E3</code>, this
column is a linear combination of the corresponding column in
<code>E2</code> and <code>E3</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">E1</span> <span class="op">&lt;-</span> <span class="va">E</span></span>
<span><span class="va">E2</span> <span class="op">&lt;-</span> <span class="va">E</span></span>
<span><span class="va">E3</span> <span class="op">&lt;-</span> <span class="va">E</span></span>
<span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">E1</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x1</span></span>
<span><span class="va">E2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x2</span></span>
<span><span class="va">E3</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">r1</span><span class="op">*</span><span class="va">x1</span> <span class="op">+</span> <span class="va">r2</span><span class="op">*</span><span class="va">x2</span></span></code></pre></div>
<p>Then we can verify the multilinearity of <span class="math inline">S</span> by coercing to a function which is applied
to <code>E1, E2, E3</code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span>
<span><span class="va">LHS</span> <span class="op">&lt;-</span> <span class="va">r1</span><span class="op">*</span><span class="fu">f</span><span class="op">(</span><span class="va">E1</span><span class="op">)</span> <span class="op">+</span> <span class="va">r2</span><span class="op">*</span><span class="fu">f</span><span class="op">(</span><span class="va">E2</span><span class="op">)</span></span>
<span><span class="va">RHS</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">E3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lhs<span class="op">=</span><span class="va">LHS</span>,rhs<span class="op">=</span><span class="va">RHS</span>,diff<span class="op">=</span><span class="va">LHS</span><span class="op">-</span><span class="va">RHS</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        lhs        rhs       diff </span></span>
<span><span class="co">## -0.5640577 -0.5640577  0.0000000</span></span></code></pre>
<p>(that is, identical up to numerical precision). Note that this is
<em>not</em> equivalent to linearity over <span class="math inline">V^{nk}</span>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">E1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">k</span><span class="op">)</span>,<span class="va">n</span>,<span class="va">k</span><span class="op">)</span></span>
<span><span class="va">E2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">k</span><span class="op">)</span>,<span class="va">n</span>,<span class="va">k</span><span class="op">)</span></span>
<span><span class="va">LHS</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">r1</span><span class="op">*</span><span class="va">E1</span><span class="op">+</span><span class="va">r2</span><span class="op">*</span><span class="va">E2</span><span class="op">)</span></span>
<span><span class="va">RHS</span> <span class="op">&lt;-</span> <span class="va">r1</span><span class="op">*</span><span class="fu">f</span><span class="op">(</span><span class="va">E1</span><span class="op">)</span><span class="op">+</span><span class="va">r2</span><span class="op">*</span><span class="fu">f</span><span class="op">(</span><span class="va">E2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lhs<span class="op">=</span><span class="va">LHS</span>,rhs<span class="op">=</span><span class="va">RHS</span>,diff<span class="op">=</span><span class="va">LHS</span><span class="op">-</span><span class="va">RHS</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        lhs        rhs       diff </span></span>
<span><span class="co">##  0.1731245  0.3074186 -0.1342941</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="tensor-product-of-general-tensors">Tensor product of general tensors<a class="anchor" aria-label="anchor" href="#tensor-product-of-general-tensors"></a>
</h4>
<p>Given two k-tensor objects <span class="math inline">S,T</span> we
can form the tensor product <span class="math inline">S\otimes T</span>,
defined as</p>
<p><span class="math display">
S\otimes T{\left(v_1,\ldots,v_k,v_{k+1},\ldots, v_{k+l}\right)}=
  S{\left(v_1,\ldots v_k\right)} \cdot T{\left(v_{k+1},\ldots
  v_{k+l}\right)}
</span></p>
<p>We will calculate the tensor product of two tensors
<code>S1,S2</code> defined as follows:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">S1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktensor.html">ktensor</a></span><span class="op">(</span><span class="fu"><a href="../reference/coeffs.html">spray</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^2 to R with V=R^4:</span></span>
<span><span class="co">##          val</span></span>
<span><span class="co">##  3 4  =    3</span></span>
<span><span class="co">##  2 3  =    2</span></span>
<span><span class="co">##  1 2  =    1</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktensor.html">as.ktensor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^3 to R with V=R^6:</span></span>
<span><span class="co">##            val</span></span>
<span><span class="co">##  2 4 6  =    1</span></span>
<span><span class="co">##  1 3 5  =    1</span></span></code></pre>
<p>The R idiom for <span class="math inline">S1\otimes S2</span> would
be <code><a href="../reference/tensorprod.html">tensorprod()</a></code>, or <code>%X%</code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tensorprod.html">tensorprod</a></span><span class="op">(</span><span class="va">S1</span>,<span class="va">S2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^5 to R with V=R^6:</span></span>
<span><span class="co">##                val</span></span>
<span><span class="co">##  1 2 1 3 5  =    1</span></span>
<span><span class="co">##  3 4 1 3 5  =    3</span></span>
<span><span class="co">##  1 2 2 4 6  =    1</span></span>
<span><span class="co">##  2 3 2 4 6  =    2</span></span>
<span><span class="co">##  2 3 1 3 5  =    2</span></span>
<span><span class="co">##  3 4 2 4 6  =    3</span></span></code></pre>
<p>Then, for example:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>,<span class="fl">6</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">LHS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="fu"><a href="../reference/tensorprod.html">tensorprod</a></span><span class="op">(</span><span class="va">S1</span>,<span class="va">S2</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="va">E</span><span class="op">)</span></span>
<span><span class="va">RHS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">(</span><span class="va">E</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">(</span><span class="va">E</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lhs<span class="op">=</span><span class="va">LHS</span>,rhs<span class="op">=</span><span class="va">RHS</span>,diff<span class="op">=</span><span class="va">LHS</span><span class="op">-</span><span class="va">RHS</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       lhs       rhs      diff </span></span>
<span><span class="co">## -1.048329 -1.048329  0.000000</span></span></code></pre>
<p>(that is, identical up to numerical precision).</p>
</div>
</div>
<div class="section level2">
<h2 id="alternating-forms">Alternating forms<a class="anchor" aria-label="anchor" href="#alternating-forms"></a>
</h2>
<p>An alternating form is a multilinear map <span class="math inline">T</span> satisfying</p>
<p><span class="math display">
T{\left(v_1,\ldots,v_i,\ldots,v_j,\ldots,v_k\right)}=
    -T{\left(v_1,\ldots,v_j,\ldots,v_i,\ldots,v_k\right)}
</span></p>
<p>(or, equivalently, <span class="math inline">T{\left(v_1,\ldots,v_i,\ldots,v_i,\ldots,v_k\right)}=
0</span>). We write <span class="math inline">\Lambda^k(V)</span> for
the space of all alternating multilinear maps from <span class="math inline">V^k</span> to <span class="math inline">\mathbb{R}</span>. Spivak gives <span class="math inline">\operatorname{Alt}\colon\mathcal{J}^k(V)\longrightarrow\Lambda^k(V)</span>
defined by</p>
<p><span class="math display">\operatorname{Alt}(T)\left(v_1,\ldots,v_k\right)=
    \frac{1}{k!}\sum_{\sigma\in S_k}\operatorname{sgn}(\sigma)\cdot
    T{\left(v_{\sigma(1)},\ldots,v_{\sigma(k)}\right)}
</span></p>
<p>where the sum ranges over all permutations of <span class="math inline">\left[n\right]=\left\{1,2,\ldots,n\right\}</span>
and <span class="math inline">\operatorname{sgn}(\sigma)\in\pm 1</span>
is the sign of the permutation. If <span class="math inline">T\in\mathcal{J}^k(V)</span> and <span class="math inline">\omega\in\Lambda^k(V)</span>, it is straightforward
to prove that <span class="math inline">\operatorname{Alt}(T)\in\Lambda^k(V)</span>, <span class="math inline">\operatorname{Alt}\left(\operatorname{Alt}\left(T\right)\right)=\operatorname{Alt}\left(T\right)</span>,
and <span class="math inline">\operatorname{Alt}\left(\omega\right)=\omega</span>.</p>
<p>In the stokes package, this is effected by the <code><a href="../reference/Alt.html">Alt()</a></code>
function:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S1</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^2 to R with V=R^4:</span></span>
<span><span class="co">##          val</span></span>
<span><span class="co">##  3 4  =    3</span></span>
<span><span class="co">##  2 3  =    2</span></span>
<span><span class="co">##  1 2  =    1</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^2 to R with V=R^4:</span></span>
<span><span class="co">##           val</span></span>
<span><span class="co">##  4 3  =  -1.5</span></span>
<span><span class="co">##  3 2  =  -1.0</span></span>
<span><span class="co">##  2 3  =   1.0</span></span>
<span><span class="co">##  3 4  =   1.5</span></span>
<span><span class="co">##  2 1  =  -0.5</span></span>
<span><span class="co">##  1 2  =   0.5</span></span></code></pre>
<p>Verifying that <code>S1</code> is in fact alternating is
straightforward:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Erev</span> <span class="op">&lt;-</span> <span class="va">E</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="va">E</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="fu"><a href="../reference/Alt.html">Alt</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="va">Erev</span><span class="op">)</span>  <span class="co"># should be zero</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<p>However, we can see that this form for alternating tensors (here
called <span class="math inline">k</span>-forms) is inefficient and
highly redundant: in this example there is a <code>1 2</code> term and a
<code>2 1</code> term (the coefficients are equal and opposite). In this
example we have <span class="math inline">k=2</span> but in general
there would be potentially <span class="math inline">k!</span>
essentially repeated terms which collectively require only a single
coefficient. The package provides <code>kform</code> objects which are
inherently alternating using a more efficient representation; they are
described using wedge products which are discussed next.</p>
<div class="section level3">
<h3 id="wedge-products-and-the-exterior-calculus">Wedge products and the exterior calculus<a class="anchor" aria-label="anchor" href="#wedge-products-and-the-exterior-calculus"></a>
</h3>
<p>This section follows the exposition of Hubbard and Hubbard, who
introduce the exterior calculus starting with a discussion of elementary
forms, which are alternating forms with a particularly simple structure.
An example of an elementary form would be <span class="math inline">\mathrm{d}x_1\wedge\mathrm{d}x_3</span> [treated as
an indivisible entity], which is an alternating multilinear map from
<span class="math inline">\mathbb{R}^n\times\mathbb{R}^n</span> to <span class="math inline">\mathbb{R}</span> with</p>
<p><span class="math display">
\left(
\mathrm{d}x_1\wedge\mathrm{d}x_3
\right)\left(
\begin{pmatrix}a_1\\a_2\\a_3\\ \vdots\\ a_n\end{pmatrix},
\begin{pmatrix}b_1\\b_3\\b_3\\ \vdots\\ b_n\end{pmatrix}
\right)=\mathrm{det}
\begin{pmatrix} a_1 &amp; b_1 \\ a_3 &amp; b_3\end{pmatrix}
=a_1b_3-a_3b_1
</span></p>
<p>That this is alternating follows from the properties of the
determinant. In general of course, <span class="math inline">\mathrm{d}x_i\wedge\mathrm{d}x_j\left(
\begin{pmatrix}a_1\\ \vdots\\
a_n\end{pmatrix}, \begin{pmatrix}b_1\\ \vdots\\ b_n\end{pmatrix}
\right)=\mathrm{det} \begin{pmatrix} a_i &amp; b_i \\ a_j &amp;
b_j\end{pmatrix}</span>. Because such objects are linear, it is possible
to consider sums of elementary forms, such as <span class="math inline">d\mathrm{x}_1\wedge\mathrm{d}x_2 + 3
\mathrm{d}x_2\wedge\mathrm{d}x_3</span> with</p>
<p><span class="math display">
\left(
\mathrm{d}x_1\wedge\mathrm{d}x_2 + 3\mathrm{d}x_2\wedge\mathrm{d}x_3
\right)\left(
\begin{pmatrix}a_1\\a_2\\ \vdots\\ a_n\end{pmatrix},
\begin{pmatrix}b_1\\b_2\\ \vdots\\ b_n\end{pmatrix}
\right)=\mathrm{det}
\begin{pmatrix} a_1 &amp; b_1\\ a_2 &amp; b_2\end{pmatrix}
+3\mathrm{det}
\begin{pmatrix} a_2 &amp; b_2\\ a_3 &amp; b_3\end{pmatrix}
</span></p>
<p>or even <span class="math inline">K=\mathrm{d}x_1\wedge\mathrm{d}x_2\wedge\mathrm{d}x_3
+5\mathrm{d}x_1\wedge\mathrm{d}x_2\wedge\mathrm{d}x_4</span> which would
be a linear map from <span class="math inline">\left(\mathbb{R}^n\right)^3</span> to <span class="math inline">\mathbb{R}</span> with</p>
<p><span class="math display">
\left(
\mathrm{d}x_4\wedge\mathrm{d}x_2\wedge\mathrm{d}x_3
+5\mathrm{d}x_1\wedge\mathrm{d}x_2\wedge\mathrm{d}x_4
\right)\left(
\begin{pmatrix}a_1\\a_2\\ \vdots\\ a_n\end{pmatrix},
\begin{pmatrix}b_1\\b_2\\ \vdots\\ b_n\end{pmatrix},
\begin{pmatrix}c_1\\c_2\\ \vdots\\ c_n\end{pmatrix}
\right)=\mathrm{det}
\begin{pmatrix}
    a_4 &amp; b_4 &amp; c_4\\
    a_2 &amp; b_2 &amp; c_2\\
    a_3 &amp; b_3 &amp; c_3
\end{pmatrix}
+5\mathrm{det}
\begin{pmatrix}
    a_1 &amp; b_1 &amp; c_1\\
    a_2 &amp; b_2 &amp; c_2\\
    a_4 &amp; b_4 &amp; c_4
\end{pmatrix}.
</span></p>
<p>Defining <span class="math inline">K</span> has ready R idiom in
which we define a matrix whose rows correspond to the differentials in
each term:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">3</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">M</span></span></code></pre></div>
<pre><code><span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]    4    2    3</span></span>
<span><span class="co">## [2,]    1    4    2</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="va">M</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">K</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^3 to R with V=R^4:</span></span>
<span><span class="co">##            val</span></span>
<span><span class="co">##  1 2 4  =   -5</span></span>
<span><span class="co">##  2 3 4  =    1</span></span></code></pre>
<p>Function <code><a href="../reference/kform.html">as.kform()</a></code> takes each row of <code>M</code> and
places the elements in increasing order; the coefficient will change
sign if the permutation is odd. Note that the order of the rows in
<code>K</code> is immaterial and indeed in some implementations will
appear in a different order: the stokes package uses the
<code>spray</code> package, which in turn utilises the STL map class of
C++.</p>
</div>
<div class="section level3">
<h3 id="formal-definition-of-dx">Formal definition of dx<a class="anchor" aria-label="anchor" href="#formal-definition-of-dx"></a>
</h3>
<p>In the previous section we defined objects such as “<span class="math inline">\mathrm{d}x_1\wedge\mathrm{d}x_6</span>” as a single
entity. Here I define the elementary form <span class="math inline">\mathrm{d}x_i</span> formally and in the next
section discuss the wedge product <span class="math inline">\wedge</span>. The elementary form <span class="math inline">\mathrm{d}x_i</span> is simply a map from <span class="math inline">\mathbb{R}^n</span> to <span class="math inline">\mathbb{R}</span> with <span class="math inline">\mathrm{d}x_i{\left(x_1,x_2,\ldots,x_n\right)}=x_i</span>.
Observe that <span class="math inline">\mathrm{d}x_i</span> is an
alternating form, even though we cannot swap arguments (because there is
only one). Package idiom for creating an elementary form appears
somewhat cryptic at first sight, but is consistent (it is easier to
understand package idiom for creating more complicated alternating
forms, as in the next section). Suppose we wish to work with <span class="math inline">\mathrm{d}x_3</span>:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dx3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>kform_symbolic_print <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># revert to default print method</span></span>
<span><span class="va">dx3</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^1 to R with V=R^3:</span></span>
<span><span class="co">##        val</span></span>
<span><span class="co">##  3  =    1</span></span></code></pre>
<p>Interpretation of the output above is not obvious (it is easier to
understand the output from more complicated alternating forms, as in the
next section), but for the moment observe that <span class="math inline">\mathrm{d}x_3</span> is indeed an alternating form,
mapping <span class="math inline">\mathbb{R}^n</span> to <span class="math inline">\mathbb{R}</span> with <span class="math inline">\mathrm{d}x_3{\left(x_1,x_2,\ldots,x_n\right)}=x_3</span>.
Thus, for example:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">dx3</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14</span>,<span class="fl">15</span>,<span class="fl">16</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 16</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">dx3</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14</span>,<span class="fl">15</span>,<span class="fl">16</span>,<span class="fl">17</span>,<span class="fl">18</span><span class="op">)</span><span class="op">)</span>  <span class="co"># idiom can deal with arbitrary vectors</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 16</span></span></code></pre>
<p>and we see that <span class="math inline">\mathrm{d}x_3</span> picks
out the third element of a vector. These are linear in the sense that we
may add and subtract these elementary forms:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dx5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">dx3</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">dx5</span><span class="op">)</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>  <span class="co"># picks out element 3 + 2*element 5</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 13</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="formal-definition-of-wedge-product">Formal definition of wedge product<a class="anchor" aria-label="anchor" href="#formal-definition-of-wedge-product"></a>
</h3>
<p>The wedge product maps two alternating forms to another alternating
form; given <span class="math inline">\omega\in\Lambda^k(V)</span> and
<span class="math inline">\eta\in\Lambda^l(V)</span>, Spivak defines the
wedge product <span class="math inline">\omega\wedge\eta\in\Lambda^{k+l}(V)</span> as</p>
<p><span class="math display">
\omega\wedge\eta={k+l\choose k\quad
l}\operatorname{Alt}(\omega\otimes\eta)
</span></p>
<p>and this is implemented in the package by function
<code><a href="../reference/wedge.html">wedge()</a></code>, or, more idiomatically, <code>^</code>:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>, <span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">3</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">K1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="va">M1</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">K1</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^3 to R with V=R^6:</span></span>
<span><span class="co">##            val</span></span>
<span><span class="co">##  1 4 6  =    7</span></span>
<span><span class="co">##  3 4 5  =   -2</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">K2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="va">M2</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">K2</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^2 to R with V=R^7:</span></span>
<span><span class="co">##          val</span></span>
<span><span class="co">##  5 7  =    5</span></span>
<span><span class="co">##  4 6  =    4</span></span>
<span><span class="co">##  3 5  =    3</span></span>
<span><span class="co">##  2 4  =    2</span></span>
<span><span class="co">##  1 3  =    1</span></span></code></pre>
<p>In symbolic notation, <code>K1</code> is equal to <span class="math inline">7\mathrm{d}x_1\wedge\mathrm{d}x_4\wedge\mathrm{d}x_6
-2\mathrm{d}x_3\wedge\mathrm{d}x_4\wedge\mathrm{d}x_5</span>. and
<code>K2</code> is <span class="math inline">\mathrm{d}x_1\wedge\mathrm{d}x_3+
2\mathrm{d}x_2\wedge\mathrm{d}x_4+ 3\mathrm{d}x_3\wedge\mathrm{d}x_5+
4\mathrm{d}x_4\wedge\mathrm{d}x_6+ 5\mathrm{d}x_5\wedge
\mathrm{d}x_7</span>. Package idiom for wedge products is
straightforward:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K1</span> <span class="op">^</span> <span class="va">K2</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^5 to R with V=R^7:</span></span>
<span><span class="co">##                val</span></span>
<span><span class="co">##  1 3 4 5 6  =  -21</span></span>
<span><span class="co">##  1 4 5 6 7  =  -35</span></span></code></pre>
<p>(we might write the product as <span class="math inline">-35\mathrm{d}x_1\wedge\mathrm{d}x_4\wedge\mathrm{d}x_5\wedge
\mathrm{d}x_6\wedge\mathrm{d}x_7
-21\mathrm{d}x_1\wedge\mathrm{d}x_3\wedge\mathrm{d}x_4\wedge\mathrm{d}x_5\wedge\mathrm{d}x_6</span>).
See how the wedge product eliminates rows with repeated entries, gathers
permuted rows together (respecting the sign of the permutation), and
expresses the result in terms of elementary forms. The product is a
linear combination of two elementary forms; note that only two
coefficients out of a possible <span class="math inline">{7\choose
5}=21</span> are nonzero. Note again that the order of the rows in the
product is arbitrary.</p>
<p>The wedge product has formal properties such as distributivity but by
far the most interesting one is associativity, which I will demonstrate
below:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">F1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>, <span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">3</span>,<span class="fl">3</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">F2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">F3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">kform_general</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">F1</span> <span class="op">^</span> <span class="va">F2</span><span class="op">)</span> <span class="op">^</span> <span class="va">F3</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^7 to R with V=R^8:</span></span>
<span><span class="co">##                    val</span></span>
<span><span class="co">##  1 2 4 5 6 7 8  =   -5</span></span>
<span><span class="co">##  2 3 4 5 6 7 8  =    6</span></span>
<span><span class="co">##  1 2 3 5 6 7 8  =   11</span></span>
<span><span class="co">##  1 2 3 4 5 6 8  =    1</span></span>
<span><span class="co">##  1 2 3 4 5 7 8  =   -5</span></span>
<span><span class="co">##  1 2 3 4 6 7 8  =    2</span></span>
<span><span class="co">##  1 2 3 4 5 6 7  =    1</span></span>
<span><span class="co">##  1 3 4 5 6 7 8  =   -2</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">F1</span> <span class="op">^</span> <span class="op">(</span><span class="va">F2</span> <span class="op">^</span> <span class="va">F3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^7 to R with V=R^8:</span></span>
<span><span class="co">##                    val</span></span>
<span><span class="co">##  2 3 4 5 6 7 8  =    6</span></span>
<span><span class="co">##  1 2 4 5 6 7 8  =   -5</span></span>
<span><span class="co">##  1 2 3 4 5 7 8  =   -5</span></span>
<span><span class="co">##  1 2 3 4 5 6 8  =    1</span></span>
<span><span class="co">##  1 2 3 4 6 7 8  =    2</span></span>
<span><span class="co">##  1 2 3 4 5 6 7  =    1</span></span>
<span><span class="co">##  1 3 4 5 6 7 8  =   -2</span></span>
<span><span class="co">##  1 2 3 5 6 7 8  =   11</span></span></code></pre>
<p>Note carefully in the above that the terms in
<code>(F1 ^ F2) ^ F3</code> and <code>F1 ^ (F2 ^ F3)</code> appear in a
different order. They are nevertheless algebraically identical, as we
may demonstrate by calculating their difference:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">F1</span> <span class="op">^</span> <span class="va">F2</span><span class="op">)</span> <span class="op">^</span> <span class="va">F3</span> <span class="op">-</span> <span class="va">F1</span> <span class="op">^</span> <span class="op">(</span><span class="va">F2</span> <span class="op">^</span> <span class="va">F3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The zero alternating linear map from V^7 to R with V=R^n:</span></span>
<span><span class="co">## empty sparse array with 7 columns</span></span></code></pre>
<p>Spivak observes that <span class="math inline">\Lambda^k(V)</span> is
spanned by the <span class="math inline">n\choose k</span> wedge
products of the form</p>
<p><span class="math display">
\mathrm{d}x_{i_1}\wedge\mathrm{d}x_{i_2}\wedge\ldots\wedge\mathrm{d}x_{i_k}\qquad
1\leq i_i&lt;i_2&lt;\cdots &lt;i_k\leq n
</span></p>
<p>where these products are the elementary forms (compare <span class="math inline">\mathcal{J}^k(V)</span>, which is spanned by <span class="math inline">n^k</span> elementary forms). Formally,
multilinearity means every element of the space <span class="math inline">\Lambda^k(V)</span> is a linear combination of
elementary forms, as illustrated in the package by function
<code><a href="../reference/kform.html">kform_general()</a></code>. Consider the following idiom:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Krel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">kform_general</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">Krel</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^2 to R with V=R^4:</span></span>
<span><span class="co">##          val</span></span>
<span><span class="co">##  3 4  =    6</span></span>
<span><span class="co">##  2 4  =    5</span></span>
<span><span class="co">##  1 4  =    4</span></span>
<span><span class="co">##  2 3  =    3</span></span>
<span><span class="co">##  1 3  =    2</span></span>
<span><span class="co">##  1 2  =    1</span></span></code></pre>
<p>Object <code>Krel</code> is a two-form, specifically a map from <span class="math inline">\left(\mathbb{R}^4\right)^2</span> to <span class="math inline">\mathbb{R}</span>. Observe that <code>Krel</code>
has <span class="math inline">{4\choose 2}=6</span> components, which do
not appear in any particular order. Addition of such <span class="math inline">k</span>-forms is straightforward in R idiom but
algebraically nontrivial:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">109</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">K2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">K1</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^2 to R with V=R^4:</span></span>
<span><span class="co">##          val</span></span>
<span><span class="co">##  2 4  =  109</span></span>
<span><span class="co">##  1 3  =    1</span></span></code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K2</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^2 to R with V=R^8:</span></span>
<span><span class="co">##          val</span></span>
<span><span class="co">##  2 4  =    4</span></span>
<span><span class="co">##  7 8  =    5</span></span>
<span><span class="co">##  1 3  =   -1</span></span></code></pre>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K1</span><span class="op">+</span><span class="va">K2</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^2 to R with V=R^8:</span></span>
<span><span class="co">##          val</span></span>
<span><span class="co">##  2 4  =  113</span></span>
<span><span class="co">##  7 8  =    5</span></span></code></pre>
<p>In the above, note how the <span class="math inline">\mathrm{d}x_2\wedge\mathrm{d}x_4</span> terms
combine [to give <code>2 4 = 113</code>] and the <span class="math inline">\mathrm{d}x_1\wedge\mathrm{d}x_3</span> term
vanishes by cancellation.</p>
</div>
<div class="section level3">
<h3 id="print-methods">Print methods<a class="anchor" aria-label="anchor" href="#print-methods"></a>
</h3>
<p>Although the spray form used above is probably the most direct and
natural representation of differential forms in numerical work,
sometimes we need a more algebraic print method.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">U</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktensor.html">ktensor</a></span><span class="op">(</span><span class="fu"><a href="../reference/coeffs.html">spray</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">U</span></span></code></pre></div>
<pre><code><span><span class="co">## A linear map from V^2 to R with V=R^5:</span></span>
<span><span class="co">##          val</span></span>
<span><span class="co">##  4 5  =    4</span></span>
<span><span class="co">##  3 4  =    3</span></span>
<span><span class="co">##  2 3  =    2</span></span>
<span><span class="co">##  1 2  =    1</span></span></code></pre>
<p>we can represent this more algebraically using the
<code><a href="../reference/symbolic.html">as.symbolic()</a></code> function:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/symbolic.html">as.symbolic</a></span><span class="op">(</span><span class="va">U</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  +4 d*e +3 c*d +2 b*c + a*b</span></span></code></pre>
<p>In the above, <code>U</code> is a multilinear map from <span class="math inline">\left(\mathbb{R}^5\right)^2</span> to <span class="math inline">\mathbb{R}</span>. Symbolically, <code>a</code>
represents the map that takes <span class="math inline">(a,b,c,d,e)</span> to <span class="math inline">a</span>, <code>b</code> the map that takes <span class="math inline">(a,b,c,d,e)</span> to <code>b</code>, and so on. The
asterisk <code>*</code> represents the tensor product <span class="math inline">\otimes</span>. Alternating forms work similarly but
<span class="math inline">k</span>-forms have different defaults:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">kform_general</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">K</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^2 to R with V=R^3:</span></span>
<span><span class="co">##          val</span></span>
<span><span class="co">##  2 3  =    3</span></span>
<span><span class="co">##  1 3  =    2</span></span>
<span><span class="co">##  1 2  =    1</span></span></code></pre>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/symbolic.html">as.symbolic</a></span><span class="op">(</span><span class="va">K</span>,d<span class="op">=</span><span class="st">"d"</span>,symbols<span class="op">=</span><span class="va">letters</span><span class="op">[</span><span class="fl">23</span><span class="op">:</span><span class="fl">26</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  +3 dx^dy +2 dw^dy + dw^dx</span></span></code></pre>
<p>Note that the wedge product <span class="math inline">\wedge</span>,
although implemented in package idiom as <code>^</code> or
<code>%^%</code>, appears in the symbolic representation as an ascii
caret, <code>^</code>.</p>
<p>We can alter the default print method with the
<code>kform_symbolic_print</code> option, which uses
<code><a href="../reference/symbolic.html">as.symbolic()</a></code>:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>kform_symbolic_print <span class="op">=</span> <span class="st">"d"</span><span class="op">)</span></span>
<span><span class="va">K</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^2 to R with V=R^3:</span></span>
<span><span class="co">##  +3 dx2^dx3 +2 dx1^dx3 + dx1^dx2</span></span></code></pre>
<p>This print option works nicely with the <code><a href="../reference/kform.html">d()</a></code> function for
elementary forms:</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fu"><a href="../reference/kform.html">d</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/kform.html">d</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">^</span> <span class="op">(</span><span class="fu"><a href="../reference/kform.html">d</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">-</span><span class="fl">5</span><span class="op">*</span><span class="fu"><a href="../reference/kform.html">d</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">^</span> <span class="fu"><a href="../reference/kform.html">d</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^3 to R with V=R^7:</span></span>
<span><span class="co">##  - dx3^dx5^dx7 + dx1^dx3^dx7 +5 dx2^dx5^dx7 -5 dx1^dx2^dx7</span></span></code></pre>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>kform_symbolic_print <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># restore default</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="contractions">Contractions<a class="anchor" aria-label="anchor" href="#contractions"></a>
</h3>
<p>Given a <span class="math inline">k</span>-form <span class="math inline">\phi\colon V^k\longrightarrow\mathbb{R}</span> and a
vector <span class="math inline">\mathbf{v}\in V</span>, the
<em>contraction</em> <span class="math inline">\phi_\mathbf{v}</span> of
<span class="math inline">\phi</span> and <span class="math inline">\mathbf{v}</span> is a <span class="math inline">k-1</span>-form with</p>
<p><span class="math display">
  \phi_\mathbf{v}{\left(\mathbf{v}^1,\ldots,\mathbf{v}^{k-1}\right)} =
  \phi{\left(\mathbf{v},\mathbf{v}^1,\ldots,\mathbf{v}^{k-1}\right)}
</span></p>
<p>if <span class="math inline">k&gt;1</span>; we specify <span class="math inline">\phi_\mathbf{v}=\phi(\mathbf{v})</span> if <span class="math inline">k=1</span>. Verification is straightforward:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rform.html">rform</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>  <span class="co"># a random 3-form</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^3 to R with V=R^7:</span></span>
<span><span class="co">##            val</span></span>
<span><span class="co">##  2 4 6  =   -6</span></span>
<span><span class="co">##  4 6 7  =    5</span></span>
<span><span class="co">##  5 6 7  =    4</span></span>
<span><span class="co">##  1 3 7  =    7</span></span>
<span><span class="co">##  1 5 7  =  -12</span></span>
<span><span class="co">##  1 4 6  =    8</span></span>
<span><span class="co">##  2 3 7  =   -2</span></span>
<span><span class="co">##  1 2 4  =    1</span></span></code></pre>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">21</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">LHS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="va">o</span><span class="op">)</span><span class="op">(</span><span class="va">V</span><span class="op">)</span></span>
<span><span class="va">RHS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="fu"><a href="../reference/contract.html">contract</a></span><span class="op">(</span><span class="va">o</span>,<span class="va">V</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="va">V</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>LHS<span class="op">=</span><span class="va">LHS</span>,RHS<span class="op">=</span><span class="va">RHS</span>,diff<span class="op">=</span><span class="va">LHS</span><span class="op">-</span><span class="va">RHS</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          LHS          RHS         diff </span></span>
<span><span class="co">## 4.512547e-01 4.512547e-01 1.110223e-16</span></span></code></pre>
<p>It is possible to iterate the contraction process; if we pass a
matrix <span class="math inline">V</span> to <code><a href="../reference/contract.html">contract()</a></code>
then this is interpreted as repeated contraction with the columns of
<span class="math inline">V</span>:</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="fu"><a href="../reference/contract.html">contract</a></span><span class="op">(</span><span class="va">o</span>,<span class="va">V</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="va">V</span><span class="op">[</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.4512547</span></span></code></pre>
<p>If we pass three columns to <code><a href="../reference/contract.html">contract()</a></code> the result is a
<span class="math inline">0</span>-form:</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/contract.html">contract</a></span><span class="op">(</span><span class="va">o</span>,<span class="va">V</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.4512547</span></span></code></pre>
<p>In the above, the result is coerced to a scalar; in order to work
with a formal <span class="math inline">0</span>-form (which is
represented in the package as a <code>spray</code> with a zero-column
index matrix) we can use the <code>lose=FALSE</code> argument:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/contract.html">contract</a></span><span class="op">(</span><span class="va">o</span>,<span class="va">V</span>,lose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^0 to R with V=R^0:</span></span>
<span><span class="co">##            val</span></span>
<span><span class="co">##   =  0.4512547</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="transformations-and-pullback">Transformations and pullback<a class="anchor" aria-label="anchor" href="#transformations-and-pullback"></a>
</h3>
<p>Suppose we are given a two-form <span class="math inline">\omega=\sum_{i&lt;j}a_{ij}dx_i\wedge
dx_j</span> and relationships <span class="math inline">dx_i=\sum_rM_{ir}dy_r</span>, then we would have</p>
<p><span class="math display">
\omega =
    \sum_{i&lt;j}
    a_{ij}\left(\sum_rM_{ir}dy_r\right)\wedge\left(\sum_rM_{jr}dy_r\right).
</span></p>
<p>The general situation would be a <span class="math inline">k</span>-form where we would have</p>
<p><span class="math display">
\omega=\sum_{i_1&lt;\cdots&lt;i_k}a_{i_1\ldots
i_k}dx_{i_1}\wedge\cdots\wedge dx_{i_k}
</span></p>
<p>giving</p>
<p><span class="math display">\omega =
    \sum_{i_1&lt;\cdots &lt;i_k}\left[
    a_{i_1&lt;\cdots &lt;
i_k}\left(\sum_rM_{i_1r}dy_r\right)\wedge\cdots\wedge\left(\sum_rM_{i_kr}dy_r\right)\right].
</span></p>
<p>So <span class="math inline">\omega</span> was given in terms of
<span class="math inline">dx_1,\ldots,dx_k</span> and we have expressed
it in terms of <span class="math inline">dy_1,\ldots,dy_k</span>. So for
example if</p>
<p><span class="math display">
\omega=
  dx_1\wedge dx_2 + 5dx_1\wedge dx_3</span></p>
<p>and</p>
<p><span class="math display">
  \left(
  \begin{array}{l}
  dx_1\\
  dx_2\\
  dx_3
  \end{array}
  \right)=
\left(
\begin{array}{ccc}
1 &amp; 4 &amp; 7\\
2 &amp; 5 &amp; 8\\
3 &amp; 6 &amp; 9\\
\end{array}
\right)  \left(
  \begin{array}{l}
  dy_1\\ dy_2\\   dy_3
  \end{array}
  \right)
</span></p>
<p>then</p>
<p><span class="math display">
\begin{array}{ccl}
  \omega &amp;=&amp;
\left(1dy_1+4dy_2+7dy_3\right)\wedge
\left(2dy_1+5dy_2+8dy_3\right)+
5\left(1dy_1+4dy_2+7dy_3\right)\wedge
\left(3dy_1+6dy_2+9dy_3\right)
\\
&amp;=&amp;2dy_1\wedge dy_1+5dy_1\wedge dy_2+\cdots+
5\cdot 7\cdot 6dx_3\wedge dx_2+
5\cdot 7\cdot 9dx_3\wedge dx_3+\\
&amp;=&amp; -33dy_1\wedge dy_2-66dy_1\wedge dy_3-33dy_2\wedge dy_3
\end{array}
</span></p>
<p>Function <code><a href="../reference/transform.html">pullback()</a></code> function does all this:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>kform_symbolic_print <span class="op">=</span> <span class="st">"dx"</span><span class="op">)</span>   <span class="co"># uses dx etc in print method</span></span>
<span><span class="fu"><a href="../reference/transform.html">pullback</a></span><span class="op">(</span><span class="va">dx</span><span class="op">^</span><span class="va">dy</span><span class="op">+</span><span class="fl">5</span><span class="op">*</span><span class="va">dx</span><span class="op">^</span><span class="va">dz</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^2 to R with V=R^3:</span></span>
<span><span class="co">##  -33 dx^dy -66 dx^dz -33 dy^dz</span></span></code></pre>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>kform_symbolic_print <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># revert to default</span></span></code></pre></div>
<p>However, it is slow and I am not 100% sure that there isn’t a much
more efficient way to do such a transformation. There are a few tests in
<code>tests/testthat</code>. Here I show that transformations may be
inverted using matrix inverses:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">^</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span> <span class="op">^</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^3 to R with V=R^5:</span></span>
<span><span class="co">##            val</span></span>
<span><span class="co">##  2 4 5  =    2</span></span></code></pre>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Then we will transform according to matrix <code>M</code> and then
transform according to the matrix inverse; the functionality works
nicely with magrittr pipes:</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/transform.html">pullback</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/transform.html">pullback</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^3 to R with V=R^5:</span></span>
<span><span class="co">##            val</span></span>
<span><span class="co">##  3 4 5  =    0</span></span>
<span><span class="co">##  1 2 3  =    0</span></span>
<span><span class="co">##  2 3 5  =    0</span></span>
<span><span class="co">##  2 3 4  =    0</span></span>
<span><span class="co">##  2 4 5  =    2</span></span>
<span><span class="co">##  1 2 5  =    0</span></span>
<span><span class="co">##  1 3 4  =    0</span></span>
<span><span class="co">##  1 2 4  =    0</span></span>
<span><span class="co">##  1 3 5  =    0</span></span>
<span><span class="co">##  1 4 5  =    0</span></span></code></pre>
<p>Above we see many rows with values small enough for the print method
to print an exact zero, but not sufficiently small to be eliminated by
the <code>spray</code> internals. We can remove the small entries with
<code><a href="https://robinhankin.github.io/stokes/reference/zap.html">zap()</a></code>:</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/transform.html">pullback</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/transform.html">pullback</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://robinhankin.github.io/stokes/reference/zap.html">zap</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^3 to R with V=R^5:</span></span>
<span><span class="co">##            val</span></span>
<span><span class="co">##  2 4 5  =    2</span></span></code></pre>
<p>See how the result is equal to the original <span class="math inline">k</span>-form <span class="math inline">2dy_2\wedge
dy_4\wedge dy_5</span>.</p>
</div>
<div class="section level3">
<h3 id="exterior-derivatives">Exterior derivatives<a class="anchor" aria-label="anchor" href="#exterior-derivatives"></a>
</h3>
<p>Given a <span class="math inline">k</span>-form <span class="math inline">\omega</span>, Spivak defines the differential of
<span class="math inline">\omega</span> to be a <span class="math inline">(k+1)</span>-form <span class="math inline">\mathrm{d}\omega</span> as follows. If</p>
<p><span class="math display">
\omega =
\sum_{
i_1 &lt; i_2 &lt;\cdots&lt;i_k}
\omega_{i_1i_2\ldots i_k}
\mathrm{d}x^{i_1}\wedge
\mathrm{d}x^{i_2}\wedge\cdots\wedge\mathrm{d}x^{i_k}
</span></p>
<p>then</p>
<p><span class="math display">
\mathrm{d}\omega =
\sum_{
i_1 &lt; i_2 &lt;\cdots&lt;i_k}
\sum_{\alpha=1}^n D_\alpha\left(\omega_{i_1i_2\ldots i_k}\right)
\cdot
\mathrm{d}x^{i_1}\wedge
\mathrm{d}x^{i_2}\wedge\cdots\wedge\mathrm{d}x^{i_k}
</span></p>
<p>where <span class="math inline">D_if(a)=\lim_{h\longrightarrow
0}\frac{f(a^1,\ldots,a^i+h,\ldots,a^n)-f(a^1,\ldots,a^i,\ldots,a^n)}{h}</span>
is the ordinary <span class="math inline">i^\mathrm{th}</span> partial
derivative (Spivak, p25). Hubbard and Hubbard take a conceptually
distinct approach and define the exterior derivative <span class="math inline">d\phi</span> (they use a bold font, <span class="math inline">\mathbf{d}\phi</span>) of the <span class="math inline">k</span>-form <span class="math inline">\phi</span>
as the <span class="math inline">(k+1)</span>-form given by</p>
<p><span class="math display">  {d}\phi
  \left({v}_i,\ldots,{v}_{k+1}\right)
  =
  \lim_{h\longrightarrow 0}\frac{1}{h^{k+1}}\int_{\partial
  P_{x}\left(h{v}_1,\ldots,h{v}_{k+1}\right)}\phi
</span></p>
<p>which, by their own account, is a rather opaque mathematical idiom.
However, the definition makes sense and it is consistent with Spivak’s
definition above. The definition allows one to express the fundamental
theorem of calculus in an arbitrary number of dimensions without
modification.</p>
<p>It can be shown that</p>
<p><span class="math display">
    \mathrm{d}{\left(f\,dx_{i_1}\wedge\cdots\wedge\mathrm{d}x_{i_k}\right)}=
    \mathrm{d}f\wedge\mathrm{d}x_{i_1}\wedge\cdots\wedge\mathrm{d}x_{i_k}
</span></p>
<p>where <span class="math inline">f\colon\mathbb{R}^n\longrightarrow\mathbb{R}</span>
is a scalar function of position. The package provides
<code><a href="../reference/as.1form.html">grad()</a></code> which, when given a vector <span class="math inline">x_1,\ldots,x_n</span> returns the one-form</p>
<p><span class="math display">
\sum_{i=1}^n x_idx_i
</span></p>
<p>This is useful because <span class="math inline">\mathrm{d}f=\sum_{j=1}^n\left(D_j
f\right)\,\mathrm{d}x_j</span>. Thus</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/as.1form.html">grad</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>,<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">3.2</span>,<span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^1 to R with V=R^4:</span></span>
<span><span class="co">##         val</span></span>
<span><span class="co">##  4  =   1.5</span></span>
<span><span class="co">##  3  =  -3.2</span></span>
<span><span class="co">##  2  =   0.1</span></span>
<span><span class="co">##  1  =   0.4</span></span></code></pre>
<p>We will use the <code><a href="../reference/as.1form.html">grad()</a></code> function to verify that, in <span class="math inline">\mathbb{R}^n</span>, a certain <span class="math inline">(k-1)</span>-form has zero work function. Motivated
by the fact that</p>
<p><span class="math display">
F_3=\frac{1}{\left(x^2+y^2+z^2\right)^{3/2}}
\begin{pmatrix}x\\y\\z\end{pmatrix}
</span></p>
<p>is a divergenceless velocity field in <span class="math inline">\mathbb{R}^3</span>, H&amp;H go on to define [page
548, equation 6.7.16]</p>
<p><span class="math display">
\omega_{n}=\mathrm{d}\frac{1}{\left(x_1^2+\ldots
+x_n^2\right)^{n/2}}\sum_{i=1}^{n}(-1)^{i-1}
x_i\mathrm{d}x_1\wedge\cdots\wedge\widehat{\mathrm{d}x_i}\wedge\cdots\wedge\mathrm{d}x_n
</span></p>
<p>(where a hat indicates the absence of a term), and show analytically
that <span class="math inline">\mathrm{d}\omega=0</span>. Here I show
this using R idiom. The first thing is to define a function that
implements the hat:</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="va">which</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>So, for example:</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">f</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^4 to R with V=R^5:</span></span>
<span><span class="co">##              val</span></span>
<span><span class="co">##  1 2 3 4  =    1</span></span>
<span><span class="co">##  1 2 3 5  =    1</span></span>
<span><span class="co">##  1 2 4 5  =    1</span></span>
<span><span class="co">##  1 3 4 5  =    1</span></span>
<span><span class="co">##  2 3 4 5  =    1</span></span></code></pre>
<p>Then we can use the <code><a href="../reference/as.1form.html">grad()</a></code> function to calculate <span class="math inline">\mathrm{d}\omega</span>, using the quotient law to
express the derivatives analytically:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/as.1form.html">grad</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>,length<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">S</span><span class="op">^</span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="va">n</span><span class="op">*</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">S</span><span class="op">^</span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">S</span><span class="op">^</span><span class="va">n</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Thus</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">df</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^1 to R with V=R^5:</span></span>
<span><span class="co">##              val</span></span>
<span><span class="co">##  5  =  -5.67e-05</span></span>
<span><span class="co">##  4  =   2.03e-05</span></span>
<span><span class="co">##  3  =   8.10e-06</span></span>
<span><span class="co">##  2  =  -2.84e-05</span></span>
<span><span class="co">##  1  =   4.05e-05</span></span></code></pre>
<p>Now we can use the wedge product of the two parts to show that the
exterior derivative is zero:</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">df</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">^</span> <span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>  <span class="co"># should be zero</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^9 to R with V=R^9:</span></span>
<span><span class="co">##                        val</span></span>
<span><span class="co">##  1 2 3 4 5 6 7 8 9  =    0</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="differential-of-the-differential-d20">Differential of the differential, <span class="math inline">d^2=0</span><a class="anchor" aria-label="anchor" href="#differential-of-the-differential-d20"></a>
</h2>
<p>We can use the package to verify the celebrated fact that, for any
<span class="math inline">k</span>-form <span class="math inline">\phi</span>, <span class="math inline">\mathrm{d}\left(\mathrm{d}\phi\right)=0</span>. The
first step is to define scalar functions <code>f1(), f2(), f3()</code>,
all <span class="math inline">0</span>-forms:</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">w</span>,<span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span><span class="op">)</span><span class="op">{</span><span class="va">x</span> <span class="op">+</span> <span class="va">y</span><span class="op">^</span><span class="fl">3</span> <span class="op">+</span> <span class="va">x</span><span class="op">*</span><span class="va">y</span><span class="op">*</span><span class="va">w</span><span class="op">*</span><span class="va">z</span><span class="op">}</span></span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">w</span>,<span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span><span class="op">)</span><span class="op">{</span><span class="va">w</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">x</span><span class="op">*</span><span class="va">y</span><span class="op">*</span><span class="va">z</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">+</span> <span class="va">w</span><span class="op">+</span><span class="va">z</span><span class="op">}</span></span>
<span><span class="va">f3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">w</span>,<span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span><span class="op">)</span><span class="op">{</span><span class="va">w</span><span class="op">*</span><span class="va">x</span><span class="op">*</span><span class="va">y</span><span class="op">*</span><span class="va">z</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
<p>Now we need to define elementary <span class="math inline">1</span>-forms:</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">dz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>I will demonstrate the theorem by defining a <span class="math inline">2</span>-form which is the sum of three elementary
two-forms, evaluated at a particular point in <span class="math inline">\mathbb{R}^4</span>:</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phi</span> <span class="op">&lt;-</span></span>
<span>  <span class="op">(</span></span>
<span>    <span class="op">+</span><span class="fu">f1</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span> <span class="op">^</span> <span class="va">dw</span> <span class="op">^</span> <span class="va">dx</span></span>
<span>    <span class="op">+</span><span class="fu">f2</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span> <span class="op">^</span> <span class="va">dw</span> <span class="op">^</span> <span class="va">dy</span></span>
<span>    <span class="op">+</span><span class="fu">f3</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span> <span class="op">^</span> <span class="va">dy</span> <span class="op">^</span> <span class="va">dz</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We could use slightly slicker R idiom by defining elementary forms
<code>e1,e2,e3</code> and then defining <code>phi</code> to be a linear
sum, weighted with <span class="math inline">0</span>-forms given by the
(scalar) functions <code>f1,f2,f3</code>:</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e1</span> <span class="op">&lt;-</span> <span class="va">dw</span> <span class="op">^</span> <span class="va">dx</span></span>
<span><span class="va">e2</span> <span class="op">&lt;-</span> <span class="va">dw</span> <span class="op">^</span> <span class="va">dy</span></span>
<span><span class="va">e3</span> <span class="op">&lt;-</span> <span class="va">dy</span> <span class="op">^</span> <span class="va">dz</span></span>
<span></span>
<span><span class="va">phi</span> <span class="op">&lt;-</span></span>
<span>  <span class="op">(</span></span>
<span>    <span class="op">+</span><span class="fu">f1</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span> <span class="op">^</span> <span class="va">e1</span></span>
<span>    <span class="op">+</span><span class="fu">f2</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span> <span class="op">^</span> <span class="va">e2</span></span>
<span>    <span class="op">+</span><span class="fu">f3</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span> <span class="op">^</span> <span class="va">e3</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">phi</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^2 to R with V=R^4:</span></span>
<span><span class="co">##               val</span></span>
<span><span class="co">##  1 3  =  29.84147</span></span>
<span><span class="co">##  1 2  =  53.00000</span></span>
<span><span class="co">##  3 4  =  25.44960</span></span></code></pre>
<p>Now to evaluate first derivatives of <code>f1()</code> etc at point
<span class="math inline">(1,2,3,4)</span>, using <code><a href="https://rdrr.io/pkg/Deriv/man/Deriv.html" class="external-link">Deriv()</a></code>
from the Deriv package:</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"Deriv"</span><span class="op">)</span></span>
<span><span class="va">Df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Deriv/man/Deriv.html" class="external-link">Deriv</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">Df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Deriv/man/Deriv.html" class="external-link">Deriv</a></span><span class="op">(</span><span class="va">f2</span><span class="op">)</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">Df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Deriv/man/Deriv.html" class="external-link">Deriv</a></span><span class="op">(</span><span class="va">f3</span><span class="op">)</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>So <code>Df1</code> etc are numeric vectors of length 4, for
example:</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Df1</span></span></code></pre></div>
<pre><code><span><span class="co">##  w  x  y  z </span></span>
<span><span class="co">## 24 13 35  6</span></span></code></pre>
<p>To calculate <code>dphi</code>, or <span class="math inline">\mathrm{d}\phi</span>, we can use function
<code><a href="../reference/as.1form.html">grad()</a></code>:</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dphi</span> <span class="op">&lt;-</span></span>
<span>  <span class="op">(</span></span>
<span>    <span class="op">+</span><span class="fu"><a href="../reference/as.1form.html">grad</a></span><span class="op">(</span><span class="va">Df1</span><span class="op">)</span> <span class="op">^</span> <span class="va">e1</span></span>
<span>    <span class="op">+</span><span class="fu"><a href="../reference/as.1form.html">grad</a></span><span class="op">(</span><span class="va">Df2</span><span class="op">)</span> <span class="op">^</span> <span class="va">e2</span></span>
<span>    <span class="op">+</span><span class="fu"><a href="../reference/as.1form.html">grad</a></span><span class="op">(</span><span class="va">Df3</span><span class="op">)</span> <span class="op">^</span> <span class="va">e3</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">dphi</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^3 to R with V=R^4:</span></span>
<span><span class="co">##                 val</span></span>
<span><span class="co">##  1 3 4  =  30.15853</span></span>
<span><span class="co">##  1 2 3  =  23.00000</span></span>
<span><span class="co">##  1 2 4  =   6.00000</span></span>
<span><span class="co">##  2 3 4  =  11.58385</span></span></code></pre>
<p>Now work on the differential of the differential. First evaluate the
Hessians (4x4 numeric matrices) at the same point:</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Hf1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Deriv/man/Deriv.html" class="external-link">Deriv</a></span><span class="op">(</span><span class="va">f1</span>,nderiv<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">Hf2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Deriv/man/Deriv.html" class="external-link">Deriv</a></span><span class="op">(</span><span class="va">f2</span>,nderiv<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">Hf3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Deriv/man/Deriv.html" class="external-link">Deriv</a></span><span class="op">(</span><span class="va">f3</span>,nderiv<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>For example</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Hf1</span></span></code></pre></div>
<pre><code><span><span class="co">##    w  x  y z</span></span>
<span><span class="co">## w  0 12  8 6</span></span>
<span><span class="co">## x 12  0  4 3</span></span>
<span><span class="co">## y  8  4 18 2</span></span>
<span><span class="co">## z  6  3  2 0</span></span></code></pre>
<p>(note the matrix is symmetric; also note carefully the nonzero
diagonal term). But <span class="math inline">dd\phi</span> is clearly
zero as the Hessians are symmetrical:</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ij</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Hf1</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Hf1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ddphi</span> <span class="op">&lt;-</span> <span class="co"># should be zero</span></span>
<span>  <span class="op">(</span></span>
<span>    <span class="op">+</span><span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="va">ij</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Hf1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">+</span><span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="va">ij</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Hf2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">+</span><span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="va">ij</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Hf3</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">ddphi</span></span></code></pre></div>
<pre><code><span><span class="co">## The zero alternating linear map from V^2 to R with V=R^n:</span></span>
<span><span class="co">## empty sparse array with 2 columns</span></span></code></pre>
<p>as expected.</p>
<div class="section level3">
<h3 id="stokess-theorem">Stokes’s theorem<a class="anchor" aria-label="anchor" href="#stokess-theorem"></a>
</h3>
<p>In its most general form, Stokes’s theorem states</p>
<p><span class="math display">
\int_{\partial X}\phi=\int_X\mathrm{d}\phi
</span></p>
<p>where <span class="math inline">X\subset\mathbb{R}^n</span> is a
compact oriented <span class="math inline">(k+1)</span>-dimensional
manifold with boundary <span class="math inline">\partial X</span> and
<span class="math inline">\phi</span> is a <span class="math inline">k</span>-form defined on a neighborhood of <span class="math inline">X</span>.</p>
<p>We will verify Stokes, following 6.9.5 of Hubbard in which</p>
<p><span class="math display">
\phi=
\left(x_1-x_2^2+x_3^3-\cdots\pm x_n^n\right)
\left(
\sum_{i=1}^n
\mathrm{d}x_1\wedge\cdots\wedge\widehat{\mathrm{d}x_i}\wedge\cdots\wedge\mathrm{d}x_n
\right)
</span></p>
<p>(a hat indicates that a term is absent), and we wish to evaluate
<span class="math inline">\int_{\partial C_a}\phi</span> where <span class="math inline">C_a</span> is the cube <span class="math inline">0\leq x_j\leq a,
1\leq j\leq n</span>. Stokes tells us that this is equal to <span class="math inline">\int_{C_a}\mathrm{d}\phi</span>, which is given
by</p>
<p><span class="math display">
d\phi = \left(
1+2x_2+\cdots + nx_n^{n-1}\right)
\mathrm{d}x_1\wedge\cdots\wedge\mathrm{d}x_n
</span></p>
<p>and so the volume integral is just</p>
<p><span class="math display">
\sum_{j=1}^n
\int_{x_1=0}^a
\int_{x_2=0}^a
\cdots
\int_{x_i=0}^a
jx_j^{j-1}
dx_1 dx_2\ldots dx_n=
a^{n-1}\left(a+a^2+\cdots+a^n\right).
</span></p>
<p>Stokes’s theorem, being trivial, is not amenable to direct numerical
verification but the package does allow slick creation of <span class="math inline">\phi</span>:</p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="va">which</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">phi</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^8 to R with V=R^9:</span></span>
<span><span class="co">##                            val</span></span>
<span><span class="co">##  2 3 4 5 6 7 8 9  =  371423053</span></span>
<span><span class="co">##  1 2 3 4 5 7 8 9  =  371423053</span></span>
<span><span class="co">##  1 3 4 5 6 7 8 9  =  371423053</span></span>
<span><span class="co">##  1 2 3 4 6 7 8 9  =  371423053</span></span>
<span><span class="co">##  1 2 3 4 5 6 7 9  =  371423053</span></span>
<span><span class="co">##  1 2 4 5 6 7 8 9  =  371423053</span></span>
<span><span class="co">##  1 2 3 5 6 7 8 9  =  371423053</span></span>
<span><span class="co">##  1 2 3 4 5 6 8 9  =  371423053</span></span>
<span><span class="co">##  1 2 3 4 5 6 7 8  =  371423053</span></span></code></pre>
<p>(recall that <code>phi</code> is a function that maps <span class="math inline">\mathbb{R}^9</span> to 8-forms. Here we choose <span class="math inline">\left(1,2,\ldots,9\right)\in\mathbb{R}^9</span> and
<code>phi(1:9)</code> as shown above is the resulting 8-form. Thus, if
we write <span class="math inline">\phi_{1:9}</span> for
<code>phi(1:9)</code> we would have <span class="math inline">\phi_{1:9}\colon\left(\mathbb{R}^9\right)^8\longrightarrow\mathbb{R}</span>,
with package idiom as follows:</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="fu">phi</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">72</span><span class="op">)</span>,<span class="fl">9</span>,<span class="fl">8</span><span class="op">)</span>   <span class="co"># (R^9)^8</span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="va">E</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -26620528</span></span></code></pre>
<p>Further, <span class="math inline">\mathrm{d}\phi</span> is given
by</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dphi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">nn</span><span class="op">*</span><span class="va">x</span><span class="op">^</span><span class="op">(</span><span class="va">nn</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="../reference/kform.html">as.kform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">dphi</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An alternating linear map from V^9 to R with V=R^9:</span></span>
<span><span class="co">##                              val</span></span>
<span><span class="co">##  1 2 3 4 5 6 7 8 9  =  405071317</span></span></code></pre>
<p>(observe that <code>dphi(1:9)</code> is a 9-form, with <span class="math inline">\mathrm{d}\phi_{1:9}\colon\left(\mathbb{R}^9\right)^9\longrightarrow\mathbb{R}</span>).
Now consider Spivak’s theorem 4.6 (page 82), which in this context
states that a 9-form is proportional to the determinant of the <span class="math inline">9\times 9</span> matrix formed from its arguments,
with constant of proportionality equal to the form evaluated on the
identity matrix <span class="math inline">I_9</span> [formally and more
generally, if <span class="math inline">v_1,\ldots,v_n</span> is a basis
for <span class="math inline">V</span>, <span class="math inline">\omega\in\Lambda^n(V)</span> and <span class="math inline">w_i=\sum a_{ij}v_j</span> then <span class="math inline">\omega\left(w_1,\ldots,w_n\right) =
\det\left(a_{ij}\right)\cdot\omega\left(v_1,\ldots v_n\right)</span>].
Numerically:</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function</a></span><span class="op">(</span><span class="fu">dphi</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">81</span><span class="op">)</span>,<span class="fl">9</span>,<span class="fl">9</span><span class="op">)</span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="va">E</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -9850953</span></span></code></pre>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/det.html" class="external-link">det</a></span><span class="op">(</span><span class="va">E</span><span class="op">)</span><span class="op">*</span><span class="fu">f</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span>  <span class="co"># should match f(E) by Spivak's 4.6</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -9850953</span></span></code></pre>
</div>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-hankin2022_disordR" class="csl-entry">
Hankin, R. K. S. 2022a. <span>“Disordered Vectors in <span>R</span>:
Introducing the <span><code>disordR</code></span> Package.”</span> <a href="https://arxiv.org/abs/2210.03856" class="external-link uri">https://arxiv.org/abs/2210.03856</a>; arXiv. <a href="https://doi.org/10.48550/ARXIV.2210.03856" class="external-link">https://doi.org/10.48550/ARXIV.2210.03856</a>.
</div>
<div id="ref-hankin2022_mvp" class="csl-entry">
———. 2022b. <span>“Fast Multivariate Polynomials in r: The
<span><code>mvp</code></span> Package.”</span> arXiv. <a href="https://doi.org/10.48550/ARXIV.2210.15991" class="external-link">https://doi.org/10.48550/ARXIV.2210.15991</a>.
</div>
<div id="ref-hankin2022_stokes" class="csl-entry">
———. 2022c. <span>“Stokes’s Theorem in <span>R</span>.”</span> arXiv. <a href="https://doi.org/10.48550/ARXIV.2210.17008" class="external-link">https://doi.org/10.48550/ARXIV.2210.17008</a>.
</div>
<div id="ref-hubbard2015" class="csl-entry">
Hubbard, J. J., and B. B. Hubbard. 2015. <em>Vector Calculus, Linear
Algebra, and Differential Forms: A Unified Approach</em>. Fifth. Matrix
Editions.
</div>
<div id="ref-spivak1965" class="csl-entry">
Spivak, M. 1965. <em>Calculus on Manifolds</em>. Addison-Wesley.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robin K. S. Hankin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
